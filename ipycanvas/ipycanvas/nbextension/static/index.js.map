{"version":3,"file":"index.js","mappings":"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","sources":["webpack://ipycanvas/./node_modules/base64-js/index.js","webpack://ipycanvas/./node_modules/buffer/index.js","webpack://ipycanvas/./node_modules/ieee754/index.js","webpack://ipycanvas/./node_modules/isarray/index.js","webpack://ipycanvas/./node_modules/roughjs/bin/geometry.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/scan-line-hachure.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/hachure-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/zigzag-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/hatch-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/dot-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/dashed-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/zigzag-line-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/math.js","webpack://ipycanvas/./node_modules/path-data-parser/lib/parser.js","webpack://ipycanvas/./node_modules/path-data-parser/lib/absolutize.js","webpack://ipycanvas/./node_modules/path-data-parser/lib/normalize.js","webpack://ipycanvas/./node_modules/roughjs/bin/renderer.js","webpack://ipycanvas/./node_modules/points-on-curve/lib/curve-to-bezier.js","webpack://ipycanvas/./node_modules/points-on-curve/lib/index.js","webpack://ipycanvas/./node_modules/roughjs/bin/generator.js","webpack://ipycanvas/./node_modules/points-on-path/lib/index.js","webpack://ipycanvas/./node_modules/roughjs/bin/canvas.js","webpack://ipycanvas/./src/extension.ts","webpack://ipycanvas/./src/index.ts","webpack://ipycanvas/./src/utils.ts","webpack://ipycanvas/./src/version.ts","webpack://ipycanvas/./src/widget.ts","webpack://ipycanvas/external amd \"@jupyter-widgets/base\"","webpack://ipycanvas/webpack/bootstrap","webpack://ipycanvas/webpack/runtime/define property getters","webpack://ipycanvas/webpack/runtime/global","webpack://ipycanvas/webpack/runtime/hasOwnProperty shorthand","webpack://ipycanvas/webpack/runtime/make namespace object","webpack://ipycanvas/webpack/startup"],"sourcesContent":["'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","export function rotatePoints(points, center, degrees) {\n    if (points && points.length) {\n        const [cx, cy] = center;\n        const angle = (Math.PI / 180) * degrees;\n        const cos = Math.cos(angle);\n        const sin = Math.sin(angle);\n        points.forEach((p) => {\n            const [x, y] = p;\n            p[0] = ((x - cx) * cos) - ((y - cy) * sin) + cx;\n            p[1] = ((x - cx) * sin) + ((y - cy) * cos) + cy;\n        });\n    }\n}\nexport function rotateLines(lines, center, degrees) {\n    const points = [];\n    lines.forEach((line) => points.push(...line));\n    rotatePoints(points, center, degrees);\n}\nexport function lineLength(line) {\n    const p1 = line[0];\n    const p2 = line[1];\n    return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2));\n}\n","import { rotatePoints, rotateLines } from '../geometry';\nexport function polygonHachureLines(polygonList, o) {\n    const angle = o.hachureAngle + 90;\n    let gap = o.hachureGap;\n    if (gap < 0) {\n        gap = o.strokeWidth * 4;\n    }\n    gap = Math.max(gap, 0.1);\n    const rotationCenter = [0, 0];\n    if (angle) {\n        for (const polygon of polygonList) {\n            rotatePoints(polygon, rotationCenter, angle);\n        }\n    }\n    const lines = straightHachureLines(polygonList, gap);\n    if (angle) {\n        for (const polygon of polygonList) {\n            rotatePoints(polygon, rotationCenter, -angle);\n        }\n        rotateLines(lines, rotationCenter, -angle);\n    }\n    return lines;\n}\nfunction straightHachureLines(polygonList, gap) {\n    const vertexArray = [];\n    for (const polygon of polygonList) {\n        const vertices = [...polygon];\n        if (vertices[0].join(',') !== vertices[vertices.length - 1].join(',')) {\n            vertices.push([vertices[0][0], vertices[0][1]]);\n        }\n        if (vertices.length > 2) {\n            vertexArray.push(vertices);\n        }\n    }\n    const lines = [];\n    gap = Math.max(gap, 0.1);\n    // Create sorted edges table\n    const edges = [];\n    for (const vertices of vertexArray) {\n        for (let i = 0; i < vertices.length - 1; i++) {\n            const p1 = vertices[i];\n            const p2 = vertices[i + 1];\n            if (p1[1] !== p2[1]) {\n                const ymin = Math.min(p1[1], p2[1]);\n                edges.push({\n                    ymin,\n                    ymax: Math.max(p1[1], p2[1]),\n                    x: ymin === p1[1] ? p1[0] : p2[0],\n                    islope: (p2[0] - p1[0]) / (p2[1] - p1[1]),\n                });\n            }\n        }\n    }\n    edges.sort((e1, e2) => {\n        if (e1.ymin < e2.ymin) {\n            return -1;\n        }\n        if (e1.ymin > e2.ymin) {\n            return 1;\n        }\n        if (e1.x < e2.x) {\n            return -1;\n        }\n        if (e1.x > e2.x) {\n            return 1;\n        }\n        if (e1.ymax === e2.ymax) {\n            return 0;\n        }\n        return (e1.ymax - e2.ymax) / Math.abs((e1.ymax - e2.ymax));\n    });\n    if (!edges.length) {\n        return lines;\n    }\n    // Start scanning\n    let activeEdges = [];\n    let y = edges[0].ymin;\n    while (activeEdges.length || edges.length) {\n        if (edges.length) {\n            let ix = -1;\n            for (let i = 0; i < edges.length; i++) {\n                if (edges[i].ymin > y) {\n                    break;\n                }\n                ix = i;\n            }\n            const removed = edges.splice(0, ix + 1);\n            removed.forEach((edge) => {\n                activeEdges.push({ s: y, edge });\n            });\n        }\n        activeEdges = activeEdges.filter((ae) => {\n            if (ae.edge.ymax <= y) {\n                return false;\n            }\n            return true;\n        });\n        activeEdges.sort((ae1, ae2) => {\n            if (ae1.edge.x === ae2.edge.x) {\n                return 0;\n            }\n            return (ae1.edge.x - ae2.edge.x) / Math.abs((ae1.edge.x - ae2.edge.x));\n        });\n        // fill between the edges\n        if (activeEdges.length > 1) {\n            for (let i = 0; i < activeEdges.length; i = i + 2) {\n                const nexti = i + 1;\n                if (nexti >= activeEdges.length) {\n                    break;\n                }\n                const ce = activeEdges[i].edge;\n                const ne = activeEdges[nexti].edge;\n                lines.push([\n                    [Math.round(ce.x), y],\n                    [Math.round(ne.x), y],\n                ]);\n            }\n        }\n        y += gap;\n        activeEdges.forEach((ae) => {\n            ae.edge.x = ae.edge.x + (gap * ae.edge.islope);\n        });\n    }\n    return lines;\n}\n","import { polygonHachureLines } from './scan-line-hachure';\nexport class HachureFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        return this._fillPolygons(polygonList, o);\n    }\n    _fillPolygons(polygonList, o) {\n        const lines = polygonHachureLines(polygonList, o);\n        const ops = this.renderLines(lines, o);\n        return { type: 'fillSketch', ops };\n    }\n    renderLines(lines, o) {\n        const ops = [];\n        for (const line of lines) {\n            ops.push(...this.helper.doubleLineOps(line[0][0], line[0][1], line[1][0], line[1][1], o));\n        }\n        return ops;\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nimport { polygonHachureLines } from './scan-line-hachure';\nimport { lineLength } from '../geometry';\nexport class ZigZagFiller extends HachureFiller {\n    fillPolygons(polygonList, o) {\n        let gap = o.hachureGap;\n        if (gap < 0) {\n            gap = o.strokeWidth * 4;\n        }\n        gap = Math.max(gap, 0.1);\n        const o2 = Object.assign({}, o, { hachureGap: gap });\n        const lines = polygonHachureLines(polygonList, o2);\n        const zigZagAngle = (Math.PI / 180) * o.hachureAngle;\n        const zigzagLines = [];\n        const dgx = gap * 0.5 * Math.cos(zigZagAngle);\n        const dgy = gap * 0.5 * Math.sin(zigZagAngle);\n        for (const [p1, p2] of lines) {\n            if (lineLength([p1, p2])) {\n                zigzagLines.push([\n                    [p1[0] - dgx, p1[1] + dgy],\n                    [...p2],\n                ], [\n                    [p1[0] + dgx, p1[1] - dgy],\n                    [...p2],\n                ]);\n            }\n        }\n        const ops = this.renderLines(zigzagLines, o);\n        return { type: 'fillSketch', ops };\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nexport class HatchFiller extends HachureFiller {\n    fillPolygons(polygonList, o) {\n        const set = this._fillPolygons(polygonList, o);\n        const o2 = Object.assign({}, o, { hachureAngle: o.hachureAngle + 90 });\n        const set2 = this._fillPolygons(polygonList, o2);\n        set.ops = set.ops.concat(set2.ops);\n        return set;\n    }\n}\n","import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class DotFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        o = Object.assign({}, o, { hachureAngle: 0 });\n        const lines = polygonHachureLines(polygonList, o);\n        return this.dotsOnLines(lines, o);\n    }\n    dotsOnLines(lines, o) {\n        const ops = [];\n        let gap = o.hachureGap;\n        if (gap < 0) {\n            gap = o.strokeWidth * 4;\n        }\n        gap = Math.max(gap, 0.1);\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        const ro = gap / 4;\n        for (const line of lines) {\n            const length = lineLength(line);\n            const dl = length / gap;\n            const count = Math.ceil(dl) - 1;\n            const offset = length - (count * gap);\n            const x = ((line[0][0] + line[1][0]) / 2) - (gap / 4);\n            const minY = Math.min(line[0][1], line[1][1]);\n            for (let i = 0; i < count; i++) {\n                const y = minY + offset + (i * gap);\n                const cx = (x - ro) + Math.random() * 2 * ro;\n                const cy = (y - ro) + Math.random() * 2 * ro;\n                const el = this.helper.ellipse(cx, cy, fweight, fweight, o);\n                ops.push(...el.ops);\n            }\n        }\n        return { type: 'fillSketch', ops };\n    }\n}\n","import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class DashedFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        const lines = polygonHachureLines(polygonList, o);\n        return { type: 'fillSketch', ops: this.dashedLine(lines, o) };\n    }\n    dashedLine(lines, o) {\n        const offset = o.dashOffset < 0 ? (o.hachureGap < 0 ? (o.strokeWidth * 4) : o.hachureGap) : o.dashOffset;\n        const gap = o.dashGap < 0 ? (o.hachureGap < 0 ? (o.strokeWidth * 4) : o.hachureGap) : o.dashGap;\n        const ops = [];\n        lines.forEach((line) => {\n            const length = lineLength(line);\n            const count = Math.floor(length / (offset + gap));\n            const startOffset = (length + gap - (count * (offset + gap))) / 2;\n            let p1 = line[0];\n            let p2 = line[1];\n            if (p1[0] > p2[0]) {\n                p1 = line[1];\n                p2 = line[0];\n            }\n            const alpha = Math.atan((p2[1] - p1[1]) / (p2[0] - p1[0]));\n            for (let i = 0; i < count; i++) {\n                const lstart = i * (offset + gap);\n                const lend = lstart + offset;\n                const start = [p1[0] + (lstart * Math.cos(alpha)) + (startOffset * Math.cos(alpha)), p1[1] + lstart * Math.sin(alpha) + (startOffset * Math.sin(alpha))];\n                const end = [p1[0] + (lend * Math.cos(alpha)) + (startOffset * Math.cos(alpha)), p1[1] + (lend * Math.sin(alpha)) + (startOffset * Math.sin(alpha))];\n                ops.push(...this.helper.doubleLineOps(start[0], start[1], end[0], end[1], o));\n            }\n        });\n        return ops;\n    }\n}\n","import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class ZigZagLineFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        const gap = o.hachureGap < 0 ? (o.strokeWidth * 4) : o.hachureGap;\n        const zo = o.zigzagOffset < 0 ? gap : o.zigzagOffset;\n        o = Object.assign({}, o, { hachureGap: gap + zo });\n        const lines = polygonHachureLines(polygonList, o);\n        return { type: 'fillSketch', ops: this.zigzagLines(lines, zo, o) };\n    }\n    zigzagLines(lines, zo, o) {\n        const ops = [];\n        lines.forEach((line) => {\n            const length = lineLength(line);\n            const count = Math.round(length / (2 * zo));\n            let p1 = line[0];\n            let p2 = line[1];\n            if (p1[0] > p2[0]) {\n                p1 = line[1];\n                p2 = line[0];\n            }\n            const alpha = Math.atan((p2[1] - p1[1]) / (p2[0] - p1[0]));\n            for (let i = 0; i < count; i++) {\n                const lstart = i * 2 * zo;\n                const lend = (i + 1) * 2 * zo;\n                const dz = Math.sqrt(2 * Math.pow(zo, 2));\n                const start = [p1[0] + (lstart * Math.cos(alpha)), p1[1] + lstart * Math.sin(alpha)];\n                const end = [p1[0] + (lend * Math.cos(alpha)), p1[1] + (lend * Math.sin(alpha))];\n                const middle = [start[0] + dz * Math.cos(alpha + Math.PI / 4), start[1] + dz * Math.sin(alpha + Math.PI / 4)];\n                ops.push(...this.helper.doubleLineOps(start[0], start[1], middle[0], middle[1], o), ...this.helper.doubleLineOps(middle[0], middle[1], end[0], end[1], o));\n            }\n        });\n        return ops;\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nimport { ZigZagFiller } from './zigzag-filler';\nimport { HatchFiller } from './hatch-filler';\nimport { DotFiller } from './dot-filler';\nimport { DashedFiller } from './dashed-filler';\nimport { ZigZagLineFiller } from './zigzag-line-filler';\nconst fillers = {};\nexport function getFiller(o, helper) {\n    let fillerName = o.fillStyle || 'hachure';\n    if (!fillers[fillerName]) {\n        switch (fillerName) {\n            case 'zigzag':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new ZigZagFiller(helper);\n                }\n                break;\n            case 'cross-hatch':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new HatchFiller(helper);\n                }\n                break;\n            case 'dots':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new DotFiller(helper);\n                }\n                break;\n            case 'dashed':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new DashedFiller(helper);\n                }\n                break;\n            case 'zigzag-line':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new ZigZagLineFiller(helper);\n                }\n                break;\n            case 'hachure':\n            default:\n                fillerName = 'hachure';\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new HachureFiller(helper);\n                }\n                break;\n        }\n    }\n    return fillers[fillerName];\n}\n","export function randomSeed() {\n    return Math.floor(Math.random() * 2 ** 31);\n}\nexport class Random {\n    constructor(seed) {\n        this.seed = seed;\n    }\n    next() {\n        if (this.seed) {\n            return ((2 ** 31 - 1) & (this.seed = Math.imul(48271, this.seed))) / 2 ** 31;\n        }\n        else {\n            return Math.random();\n        }\n    }\n}\n","const COMMAND = 0;\nconst NUMBER = 1;\nconst EOD = 2;\nconst PARAMS = { A: 7, a: 7, C: 6, c: 6, H: 1, h: 1, L: 2, l: 2, M: 2, m: 2, Q: 4, q: 4, S: 4, s: 4, T: 2, t: 2, V: 1, v: 1, Z: 0, z: 0 };\nfunction tokenize(d) {\n    const tokens = new Array();\n    while (d !== '') {\n        if (d.match(/^([ \\t\\r\\n,]+)/)) {\n            d = d.substr(RegExp.$1.length);\n        }\n        else if (d.match(/^([aAcChHlLmMqQsStTvVzZ])/)) {\n            tokens[tokens.length] = { type: COMMAND, text: RegExp.$1 };\n            d = d.substr(RegExp.$1.length);\n        }\n        else if (d.match(/^(([-+]?[0-9]+(\\.[0-9]*)?|[-+]?\\.[0-9]+)([eE][-+]?[0-9]+)?)/)) {\n            tokens[tokens.length] = { type: NUMBER, text: `${parseFloat(RegExp.$1)}` };\n            d = d.substr(RegExp.$1.length);\n        }\n        else {\n            return [];\n        }\n    }\n    tokens[tokens.length] = { type: EOD, text: '' };\n    return tokens;\n}\nfunction isType(token, type) {\n    return token.type === type;\n}\nexport function parsePath(d) {\n    const segments = [];\n    const tokens = tokenize(d);\n    let mode = 'BOD';\n    let index = 0;\n    let token = tokens[index];\n    while (!isType(token, EOD)) {\n        let paramsCount = 0;\n        const params = [];\n        if (mode === 'BOD') {\n            if (token.text === 'M' || token.text === 'm') {\n                index++;\n                paramsCount = PARAMS[token.text];\n                mode = token.text;\n            }\n            else {\n                return parsePath('M0,0' + d);\n            }\n        }\n        else if (isType(token, NUMBER)) {\n            paramsCount = PARAMS[mode];\n        }\n        else {\n            index++;\n            paramsCount = PARAMS[token.text];\n            mode = token.text;\n        }\n        if ((index + paramsCount) < tokens.length) {\n            for (let i = index; i < index + paramsCount; i++) {\n                const numbeToken = tokens[i];\n                if (isType(numbeToken, NUMBER)) {\n                    params[params.length] = +numbeToken.text;\n                }\n                else {\n                    throw new Error('Param not a number: ' + mode + ',' + numbeToken.text);\n                }\n            }\n            if (typeof PARAMS[mode] === 'number') {\n                const segment = { key: mode, data: params };\n                segments.push(segment);\n                index += paramsCount;\n                token = tokens[index];\n                if (mode === 'M')\n                    mode = 'L';\n                if (mode === 'm')\n                    mode = 'l';\n            }\n            else {\n                throw new Error('Bad segment: ' + mode);\n            }\n        }\n        else {\n            throw new Error('Path data ended short');\n        }\n    }\n    return segments;\n}\nexport function serialize(segments) {\n    const tokens = [];\n    for (const { key, data } of segments) {\n        tokens.push(key);\n        switch (key) {\n            case 'C':\n            case 'c':\n                tokens.push(data[0], `${data[1]},`, data[2], `${data[3]},`, data[4], data[5]);\n                break;\n            case 'S':\n            case 's':\n            case 'Q':\n            case 'q':\n                tokens.push(data[0], `${data[1]},`, data[2], data[3]);\n                break;\n            default:\n                tokens.push(...data);\n                break;\n        }\n    }\n    return tokens.join(' ');\n}\n","// Translate relative commands to absolute commands\nexport function absolutize(segments) {\n    let cx = 0, cy = 0;\n    let subx = 0, suby = 0;\n    const out = [];\n    for (const { key, data } of segments) {\n        switch (key) {\n            case 'M':\n                out.push({ key: 'M', data: [...data] });\n                [cx, cy] = data;\n                [subx, suby] = data;\n                break;\n            case 'm':\n                cx += data[0];\n                cy += data[1];\n                out.push({ key: 'M', data: [cx, cy] });\n                subx = cx;\n                suby = cy;\n                break;\n            case 'L':\n                out.push({ key: 'L', data: [...data] });\n                [cx, cy] = data;\n                break;\n            case 'l':\n                cx += data[0];\n                cy += data[1];\n                out.push({ key: 'L', data: [cx, cy] });\n                break;\n            case 'C':\n                out.push({ key: 'C', data: [...data] });\n                cx = data[4];\n                cy = data[5];\n                break;\n            case 'c': {\n                const newdata = data.map((d, i) => (i % 2) ? (d + cy) : (d + cx));\n                out.push({ key: 'C', data: newdata });\n                cx = newdata[4];\n                cy = newdata[5];\n                break;\n            }\n            case 'Q':\n                out.push({ key: 'Q', data: [...data] });\n                cx = data[2];\n                cy = data[3];\n                break;\n            case 'q': {\n                const newdata = data.map((d, i) => (i % 2) ? (d + cy) : (d + cx));\n                out.push({ key: 'Q', data: newdata });\n                cx = newdata[2];\n                cy = newdata[3];\n                break;\n            }\n            case 'A':\n                out.push({ key: 'A', data: [...data] });\n                cx = data[5];\n                cy = data[6];\n                break;\n            case 'a':\n                cx += data[5];\n                cy += data[6];\n                out.push({ key: 'A', data: [data[0], data[1], data[2], data[3], data[4], cx, cy] });\n                break;\n            case 'H':\n                out.push({ key: 'H', data: [...data] });\n                cx = data[0];\n                break;\n            case 'h':\n                cx += data[0];\n                out.push({ key: 'H', data: [cx] });\n                break;\n            case 'V':\n                out.push({ key: 'V', data: [...data] });\n                cy = data[0];\n                break;\n            case 'v':\n                cy += data[0];\n                out.push({ key: 'V', data: [cy] });\n                break;\n            case 'S':\n                out.push({ key: 'S', data: [...data] });\n                cx = data[2];\n                cy = data[3];\n                break;\n            case 's': {\n                const newdata = data.map((d, i) => (i % 2) ? (d + cy) : (d + cx));\n                out.push({ key: 'S', data: newdata });\n                cx = newdata[2];\n                cy = newdata[3];\n                break;\n            }\n            case 'T':\n                out.push({ key: 'T', data: [...data] });\n                cx = data[0];\n                cy = data[1];\n                break;\n            case 't':\n                cx += data[0];\n                cy += data[1];\n                out.push({ key: 'T', data: [cx, cy] });\n                break;\n            case 'Z':\n            case 'z':\n                out.push({ key: 'Z', data: [] });\n                cx = subx;\n                cy = suby;\n                break;\n        }\n    }\n    return out;\n}\n","// Normalize path to include only M, L, C, and Z commands\nexport function normalize(segments) {\n    const out = [];\n    let lastType = '';\n    let cx = 0, cy = 0;\n    let subx = 0, suby = 0;\n    let lcx = 0, lcy = 0;\n    for (const { key, data } of segments) {\n        switch (key) {\n            case 'M':\n                out.push({ key: 'M', data: [...data] });\n                [cx, cy] = data;\n                [subx, suby] = data;\n                break;\n            case 'C':\n                out.push({ key: 'C', data: [...data] });\n                cx = data[4];\n                cy = data[5];\n                lcx = data[2];\n                lcy = data[3];\n                break;\n            case 'L':\n                out.push({ key: 'L', data: [...data] });\n                [cx, cy] = data;\n                break;\n            case 'H':\n                cx = data[0];\n                out.push({ key: 'L', data: [cx, cy] });\n                break;\n            case 'V':\n                cy = data[0];\n                out.push({ key: 'L', data: [cx, cy] });\n                break;\n            case 'S': {\n                let cx1 = 0, cy1 = 0;\n                if (lastType === 'C' || lastType === 'S') {\n                    cx1 = cx + (cx - lcx);\n                    cy1 = cy + (cy - lcy);\n                }\n                else {\n                    cx1 = cx;\n                    cy1 = cy;\n                }\n                out.push({ key: 'C', data: [cx1, cy1, ...data] });\n                lcx = data[0];\n                lcy = data[1];\n                cx = data[2];\n                cy = data[3];\n                break;\n            }\n            case 'T': {\n                const [x, y] = data;\n                let x1 = 0, y1 = 0;\n                if (lastType === 'Q' || lastType === 'T') {\n                    x1 = cx + (cx - lcx);\n                    y1 = cy + (cy - lcy);\n                }\n                else {\n                    x1 = cx;\n                    y1 = cy;\n                }\n                const cx1 = cx + 2 * (x1 - cx) / 3;\n                const cy1 = cy + 2 * (y1 - cy) / 3;\n                const cx2 = x + 2 * (x1 - x) / 3;\n                const cy2 = y + 2 * (y1 - y) / 3;\n                out.push({ key: 'C', data: [cx1, cy1, cx2, cy2, x, y] });\n                lcx = x1;\n                lcy = y1;\n                cx = x;\n                cy = y;\n                break;\n            }\n            case 'Q': {\n                const [x1, y1, x, y] = data;\n                const cx1 = cx + 2 * (x1 - cx) / 3;\n                const cy1 = cy + 2 * (y1 - cy) / 3;\n                const cx2 = x + 2 * (x1 - x) / 3;\n                const cy2 = y + 2 * (y1 - y) / 3;\n                out.push({ key: 'C', data: [cx1, cy1, cx2, cy2, x, y] });\n                lcx = x1;\n                lcy = y1;\n                cx = x;\n                cy = y;\n                break;\n            }\n            case 'A': {\n                const r1 = Math.abs(data[0]);\n                const r2 = Math.abs(data[1]);\n                const angle = data[2];\n                const largeArcFlag = data[3];\n                const sweepFlag = data[4];\n                const x = data[5];\n                const y = data[6];\n                if (r1 === 0 || r2 === 0) {\n                    out.push({ key: 'C', data: [cx, cy, x, y, x, y] });\n                    cx = x;\n                    cy = y;\n                }\n                else {\n                    if (cx !== x || cy !== y) {\n                        const curves = arcToCubicCurves(cx, cy, x, y, r1, r2, angle, largeArcFlag, sweepFlag);\n                        curves.forEach(function (curve) {\n                            out.push({ key: 'C', data: curve });\n                        });\n                        cx = x;\n                        cy = y;\n                    }\n                }\n                break;\n            }\n            case 'Z':\n                out.push({ key: 'Z', data: [] });\n                cx = subx;\n                cy = suby;\n                break;\n        }\n        lastType = key;\n    }\n    return out;\n}\nfunction degToRad(degrees) {\n    return (Math.PI * degrees) / 180;\n}\nfunction rotate(x, y, angleRad) {\n    const X = x * Math.cos(angleRad) - y * Math.sin(angleRad);\n    const Y = x * Math.sin(angleRad) + y * Math.cos(angleRad);\n    return [X, Y];\n}\nfunction arcToCubicCurves(x1, y1, x2, y2, r1, r2, angle, largeArcFlag, sweepFlag, recursive) {\n    const angleRad = degToRad(angle);\n    let params = [];\n    let f1 = 0, f2 = 0, cx = 0, cy = 0;\n    if (recursive) {\n        [f1, f2, cx, cy] = recursive;\n    }\n    else {\n        [x1, y1] = rotate(x1, y1, -angleRad);\n        [x2, y2] = rotate(x2, y2, -angleRad);\n        const x = (x1 - x2) / 2;\n        const y = (y1 - y2) / 2;\n        let h = (x * x) / (r1 * r1) + (y * y) / (r2 * r2);\n        if (h > 1) {\n            h = Math.sqrt(h);\n            r1 = h * r1;\n            r2 = h * r2;\n        }\n        const sign = (largeArcFlag === sweepFlag) ? -1 : 1;\n        const r1Pow = r1 * r1;\n        const r2Pow = r2 * r2;\n        const left = r1Pow * r2Pow - r1Pow * y * y - r2Pow * x * x;\n        const right = r1Pow * y * y + r2Pow * x * x;\n        const k = sign * Math.sqrt(Math.abs(left / right));\n        cx = k * r1 * y / r2 + (x1 + x2) / 2;\n        cy = k * -r2 * x / r1 + (y1 + y2) / 2;\n        f1 = Math.asin(parseFloat(((y1 - cy) / r2).toFixed(9)));\n        f2 = Math.asin(parseFloat(((y2 - cy) / r2).toFixed(9)));\n        if (x1 < cx) {\n            f1 = Math.PI - f1;\n        }\n        if (x2 < cx) {\n            f2 = Math.PI - f2;\n        }\n        if (f1 < 0) {\n            f1 = Math.PI * 2 + f1;\n        }\n        if (f2 < 0) {\n            f2 = Math.PI * 2 + f2;\n        }\n        if (sweepFlag && f1 > f2) {\n            f1 = f1 - Math.PI * 2;\n        }\n        if (!sweepFlag && f2 > f1) {\n            f2 = f2 - Math.PI * 2;\n        }\n    }\n    let df = f2 - f1;\n    if (Math.abs(df) > (Math.PI * 120 / 180)) {\n        const f2old = f2;\n        const x2old = x2;\n        const y2old = y2;\n        if (sweepFlag && f2 > f1) {\n            f2 = f1 + (Math.PI * 120 / 180) * (1);\n        }\n        else {\n            f2 = f1 + (Math.PI * 120 / 180) * (-1);\n        }\n        x2 = cx + r1 * Math.cos(f2);\n        y2 = cy + r2 * Math.sin(f2);\n        params = arcToCubicCurves(x2, y2, x2old, y2old, r1, r2, angle, 0, sweepFlag, [f2, f2old, cx, cy]);\n    }\n    df = f2 - f1;\n    const c1 = Math.cos(f1);\n    const s1 = Math.sin(f1);\n    const c2 = Math.cos(f2);\n    const s2 = Math.sin(f2);\n    const t = Math.tan(df / 4);\n    const hx = 4 / 3 * r1 * t;\n    const hy = 4 / 3 * r2 * t;\n    const m1 = [x1, y1];\n    const m2 = [x1 + hx * s1, y1 - hy * c1];\n    const m3 = [x2 + hx * s2, y2 - hy * c2];\n    const m4 = [x2, y2];\n    m2[0] = 2 * m1[0] - m2[0];\n    m2[1] = 2 * m1[1] - m2[1];\n    if (recursive) {\n        return [m2, m3, m4].concat(params);\n    }\n    else {\n        params = [m2, m3, m4].concat(params);\n        const curves = [];\n        for (let i = 0; i < params.length; i += 3) {\n            const r1 = rotate(params[i][0], params[i][1], angleRad);\n            const r2 = rotate(params[i + 1][0], params[i + 1][1], angleRad);\n            const r3 = rotate(params[i + 2][0], params[i + 2][1], angleRad);\n            curves.push([r1[0], r1[1], r2[0], r2[1], r3[0], r3[1]]);\n        }\n        return curves;\n    }\n}\n","import { getFiller } from './fillers/filler.js';\nimport { Random } from './math.js';\nimport { parsePath, normalize, absolutize } from 'path-data-parser';\nconst helper = {\n    randOffset,\n    randOffsetWithRange,\n    ellipse,\n    doubleLineOps: doubleLineFillOps,\n};\nexport function line(x1, y1, x2, y2, o) {\n    return { type: 'path', ops: _doubleLine(x1, y1, x2, y2, o) };\n}\nexport function linearPath(points, close, o) {\n    const len = (points || []).length;\n    if (len > 2) {\n        const ops = [];\n        for (let i = 0; i < (len - 1); i++) {\n            ops.push(..._doubleLine(points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], o));\n        }\n        if (close) {\n            ops.push(..._doubleLine(points[len - 1][0], points[len - 1][1], points[0][0], points[0][1], o));\n        }\n        return { type: 'path', ops };\n    }\n    else if (len === 2) {\n        return line(points[0][0], points[0][1], points[1][0], points[1][1], o);\n    }\n    return { type: 'path', ops: [] };\n}\nexport function polygon(points, o) {\n    return linearPath(points, true, o);\n}\nexport function rectangle(x, y, width, height, o) {\n    const points = [\n        [x, y],\n        [x + width, y],\n        [x + width, y + height],\n        [x, y + height],\n    ];\n    return polygon(points, o);\n}\nexport function curve(points, o) {\n    let o1 = _curveWithOffset(points, 1 * (1 + o.roughness * 0.2), o);\n    if (!o.disableMultiStroke) {\n        const o2 = _curveWithOffset(points, 1.5 * (1 + o.roughness * 0.22), cloneOptionsAlterSeed(o));\n        o1 = o1.concat(o2);\n    }\n    return { type: 'path', ops: o1 };\n}\nexport function ellipse(x, y, width, height, o) {\n    const params = generateEllipseParams(width, height, o);\n    return ellipseWithParams(x, y, o, params).opset;\n}\nexport function generateEllipseParams(width, height, o) {\n    const psq = Math.sqrt(Math.PI * 2 * Math.sqrt((Math.pow(width / 2, 2) + Math.pow(height / 2, 2)) / 2));\n    const stepCount = Math.ceil(Math.max(o.curveStepCount, (o.curveStepCount / Math.sqrt(200)) * psq));\n    const increment = (Math.PI * 2) / stepCount;\n    let rx = Math.abs(width / 2);\n    let ry = Math.abs(height / 2);\n    const curveFitRandomness = 1 - o.curveFitting;\n    rx += _offsetOpt(rx * curveFitRandomness, o);\n    ry += _offsetOpt(ry * curveFitRandomness, o);\n    return { increment, rx, ry };\n}\nexport function ellipseWithParams(x, y, o, ellipseParams) {\n    const [ap1, cp1] = _computeEllipsePoints(ellipseParams.increment, x, y, ellipseParams.rx, ellipseParams.ry, 1, ellipseParams.increment * _offset(0.1, _offset(0.4, 1, o), o), o);\n    let o1 = _curve(ap1, null, o);\n    if ((!o.disableMultiStroke) && (o.roughness !== 0)) {\n        const [ap2] = _computeEllipsePoints(ellipseParams.increment, x, y, ellipseParams.rx, ellipseParams.ry, 1.5, 0, o);\n        const o2 = _curve(ap2, null, o);\n        o1 = o1.concat(o2);\n    }\n    return {\n        estimatedPoints: cp1,\n        opset: { type: 'path', ops: o1 },\n    };\n}\nexport function arc(x, y, width, height, start, stop, closed, roughClosure, o) {\n    const cx = x;\n    const cy = y;\n    let rx = Math.abs(width / 2);\n    let ry = Math.abs(height / 2);\n    rx += _offsetOpt(rx * 0.01, o);\n    ry += _offsetOpt(ry * 0.01, o);\n    let strt = start;\n    let stp = stop;\n    while (strt < 0) {\n        strt += Math.PI * 2;\n        stp += Math.PI * 2;\n    }\n    if ((stp - strt) > (Math.PI * 2)) {\n        strt = 0;\n        stp = Math.PI * 2;\n    }\n    const ellipseInc = (Math.PI * 2) / o.curveStepCount;\n    const arcInc = Math.min(ellipseInc / 2, (stp - strt) / 2);\n    const ops = _arc(arcInc, cx, cy, rx, ry, strt, stp, 1, o);\n    if (!o.disableMultiStroke) {\n        const o2 = _arc(arcInc, cx, cy, rx, ry, strt, stp, 1.5, o);\n        ops.push(...o2);\n    }\n    if (closed) {\n        if (roughClosure) {\n            ops.push(..._doubleLine(cx, cy, cx + rx * Math.cos(strt), cy + ry * Math.sin(strt), o), ..._doubleLine(cx, cy, cx + rx * Math.cos(stp), cy + ry * Math.sin(stp), o));\n        }\n        else {\n            ops.push({ op: 'lineTo', data: [cx, cy] }, { op: 'lineTo', data: [cx + rx * Math.cos(strt), cy + ry * Math.sin(strt)] });\n        }\n    }\n    return { type: 'path', ops };\n}\nexport function svgPath(path, o) {\n    const segments = normalize(absolutize(parsePath(path)));\n    const ops = [];\n    let first = [0, 0];\n    let current = [0, 0];\n    for (const { key, data } of segments) {\n        switch (key) {\n            case 'M': {\n                const ro = 1 * (o.maxRandomnessOffset || 0);\n                const pv = o.preserveVertices;\n                ops.push({ op: 'move', data: data.map((d) => d + (pv ? 0 : _offsetOpt(ro, o))) });\n                current = [data[0], data[1]];\n                first = [data[0], data[1]];\n                break;\n            }\n            case 'L':\n                ops.push(..._doubleLine(current[0], current[1], data[0], data[1], o));\n                current = [data[0], data[1]];\n                break;\n            case 'C': {\n                const [x1, y1, x2, y2, x, y] = data;\n                ops.push(..._bezierTo(x1, y1, x2, y2, x, y, current, o));\n                current = [x, y];\n                break;\n            }\n            case 'Z':\n                ops.push(..._doubleLine(current[0], current[1], first[0], first[1], o));\n                current = [first[0], first[1]];\n                break;\n        }\n    }\n    return { type: 'path', ops };\n}\n// Fills\nexport function solidFillPolygon(polygonList, o) {\n    const ops = [];\n    for (const points of polygonList) {\n        if (points.length) {\n            const offset = o.maxRandomnessOffset || 0;\n            const len = points.length;\n            if (len > 2) {\n                ops.push({ op: 'move', data: [points[0][0] + _offsetOpt(offset, o), points[0][1] + _offsetOpt(offset, o)] });\n                for (let i = 1; i < len; i++) {\n                    ops.push({ op: 'lineTo', data: [points[i][0] + _offsetOpt(offset, o), points[i][1] + _offsetOpt(offset, o)] });\n                }\n            }\n        }\n    }\n    return { type: 'fillPath', ops };\n}\nexport function patternFillPolygons(polygonList, o) {\n    return getFiller(o, helper).fillPolygons(polygonList, o);\n}\nexport function patternFillArc(x, y, width, height, start, stop, o) {\n    const cx = x;\n    const cy = y;\n    let rx = Math.abs(width / 2);\n    let ry = Math.abs(height / 2);\n    rx += _offsetOpt(rx * 0.01, o);\n    ry += _offsetOpt(ry * 0.01, o);\n    let strt = start;\n    let stp = stop;\n    while (strt < 0) {\n        strt += Math.PI * 2;\n        stp += Math.PI * 2;\n    }\n    if ((stp - strt) > (Math.PI * 2)) {\n        strt = 0;\n        stp = Math.PI * 2;\n    }\n    const increment = (stp - strt) / o.curveStepCount;\n    const points = [];\n    for (let angle = strt; angle <= stp; angle = angle + increment) {\n        points.push([cx + rx * Math.cos(angle), cy + ry * Math.sin(angle)]);\n    }\n    points.push([cx + rx * Math.cos(stp), cy + ry * Math.sin(stp)]);\n    points.push([cx, cy]);\n    return patternFillPolygons([points], o);\n}\nexport function randOffset(x, o) {\n    return _offsetOpt(x, o);\n}\nexport function randOffsetWithRange(min, max, o) {\n    return _offset(min, max, o);\n}\nexport function doubleLineFillOps(x1, y1, x2, y2, o) {\n    return _doubleLine(x1, y1, x2, y2, o, true);\n}\n// Private helpers\nfunction cloneOptionsAlterSeed(ops) {\n    const result = Object.assign({}, ops);\n    result.randomizer = undefined;\n    if (ops.seed) {\n        result.seed = ops.seed + 1;\n    }\n    return result;\n}\nfunction random(ops) {\n    if (!ops.randomizer) {\n        ops.randomizer = new Random(ops.seed || 0);\n    }\n    return ops.randomizer.next();\n}\nfunction _offset(min, max, ops, roughnessGain = 1) {\n    return ops.roughness * roughnessGain * ((random(ops) * (max - min)) + min);\n}\nfunction _offsetOpt(x, ops, roughnessGain = 1) {\n    return _offset(-x, x, ops, roughnessGain);\n}\nfunction _doubleLine(x1, y1, x2, y2, o, filling = false) {\n    const singleStroke = filling ? o.disableMultiStrokeFill : o.disableMultiStroke;\n    const o1 = _line(x1, y1, x2, y2, o, true, false);\n    if (singleStroke) {\n        return o1;\n    }\n    const o2 = _line(x1, y1, x2, y2, o, true, true);\n    return o1.concat(o2);\n}\nfunction _line(x1, y1, x2, y2, o, move, overlay) {\n    const lengthSq = Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2);\n    const length = Math.sqrt(lengthSq);\n    let roughnessGain = 1;\n    if (length < 200) {\n        roughnessGain = 1;\n    }\n    else if (length > 500) {\n        roughnessGain = 0.4;\n    }\n    else {\n        roughnessGain = (-0.0016668) * length + 1.233334;\n    }\n    let offset = o.maxRandomnessOffset || 0;\n    if ((offset * offset * 100) > lengthSq) {\n        offset = length / 10;\n    }\n    const halfOffset = offset / 2;\n    const divergePoint = 0.2 + random(o) * 0.2;\n    let midDispX = o.bowing * o.maxRandomnessOffset * (y2 - y1) / 200;\n    let midDispY = o.bowing * o.maxRandomnessOffset * (x1 - x2) / 200;\n    midDispX = _offsetOpt(midDispX, o, roughnessGain);\n    midDispY = _offsetOpt(midDispY, o, roughnessGain);\n    const ops = [];\n    const randomHalf = () => _offsetOpt(halfOffset, o, roughnessGain);\n    const randomFull = () => _offsetOpt(offset, o, roughnessGain);\n    const preserveVertices = o.preserveVertices;\n    if (move) {\n        if (overlay) {\n            ops.push({\n                op: 'move', data: [\n                    x1 + (preserveVertices ? 0 : randomHalf()),\n                    y1 + (preserveVertices ? 0 : randomHalf()),\n                ],\n            });\n        }\n        else {\n            ops.push({\n                op: 'move', data: [\n                    x1 + (preserveVertices ? 0 : _offsetOpt(offset, o, roughnessGain)),\n                    y1 + (preserveVertices ? 0 : _offsetOpt(offset, o, roughnessGain)),\n                ],\n            });\n        }\n    }\n    if (overlay) {\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                midDispX + x1 + (x2 - x1) * divergePoint + randomHalf(),\n                midDispY + y1 + (y2 - y1) * divergePoint + randomHalf(),\n                midDispX + x1 + 2 * (x2 - x1) * divergePoint + randomHalf(),\n                midDispY + y1 + 2 * (y2 - y1) * divergePoint + randomHalf(),\n                x2 + (preserveVertices ? 0 : randomHalf()),\n                y2 + (preserveVertices ? 0 : randomHalf()),\n            ],\n        });\n    }\n    else {\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                midDispX + x1 + (x2 - x1) * divergePoint + randomFull(),\n                midDispY + y1 + (y2 - y1) * divergePoint + randomFull(),\n                midDispX + x1 + 2 * (x2 - x1) * divergePoint + randomFull(),\n                midDispY + y1 + 2 * (y2 - y1) * divergePoint + randomFull(),\n                x2 + (preserveVertices ? 0 : randomFull()),\n                y2 + (preserveVertices ? 0 : randomFull()),\n            ],\n        });\n    }\n    return ops;\n}\nfunction _curveWithOffset(points, offset, o) {\n    const ps = [];\n    ps.push([\n        points[0][0] + _offsetOpt(offset, o),\n        points[0][1] + _offsetOpt(offset, o),\n    ]);\n    ps.push([\n        points[0][0] + _offsetOpt(offset, o),\n        points[0][1] + _offsetOpt(offset, o),\n    ]);\n    for (let i = 1; i < points.length; i++) {\n        ps.push([\n            points[i][0] + _offsetOpt(offset, o),\n            points[i][1] + _offsetOpt(offset, o),\n        ]);\n        if (i === (points.length - 1)) {\n            ps.push([\n                points[i][0] + _offsetOpt(offset, o),\n                points[i][1] + _offsetOpt(offset, o),\n            ]);\n        }\n    }\n    return _curve(ps, null, o);\n}\nfunction _curve(points, closePoint, o) {\n    const len = points.length;\n    const ops = [];\n    if (len > 3) {\n        const b = [];\n        const s = 1 - o.curveTightness;\n        ops.push({ op: 'move', data: [points[1][0], points[1][1]] });\n        for (let i = 1; (i + 2) < len; i++) {\n            const cachedVertArray = points[i];\n            b[0] = [cachedVertArray[0], cachedVertArray[1]];\n            b[1] = [cachedVertArray[0] + (s * points[i + 1][0] - s * points[i - 1][0]) / 6, cachedVertArray[1] + (s * points[i + 1][1] - s * points[i - 1][1]) / 6];\n            b[2] = [points[i + 1][0] + (s * points[i][0] - s * points[i + 2][0]) / 6, points[i + 1][1] + (s * points[i][1] - s * points[i + 2][1]) / 6];\n            b[3] = [points[i + 1][0], points[i + 1][1]];\n            ops.push({ op: 'bcurveTo', data: [b[1][0], b[1][1], b[2][0], b[2][1], b[3][0], b[3][1]] });\n        }\n        if (closePoint && closePoint.length === 2) {\n            const ro = o.maxRandomnessOffset;\n            ops.push({ op: 'lineTo', data: [closePoint[0] + _offsetOpt(ro, o), closePoint[1] + _offsetOpt(ro, o)] });\n        }\n    }\n    else if (len === 3) {\n        ops.push({ op: 'move', data: [points[1][0], points[1][1]] });\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                points[1][0], points[1][1],\n                points[2][0], points[2][1],\n                points[2][0], points[2][1],\n            ],\n        });\n    }\n    else if (len === 2) {\n        ops.push(..._doubleLine(points[0][0], points[0][1], points[1][0], points[1][1], o));\n    }\n    return ops;\n}\nfunction _computeEllipsePoints(increment, cx, cy, rx, ry, offset, overlap, o) {\n    const coreOnly = o.roughness === 0;\n    const corePoints = [];\n    const allPoints = [];\n    if (coreOnly) {\n        increment = increment / 4;\n        allPoints.push([\n            cx + rx * Math.cos(-increment),\n            cy + ry * Math.sin(-increment),\n        ]);\n        for (let angle = 0; angle <= Math.PI * 2; angle = angle + increment) {\n            const p = [\n                cx + rx * Math.cos(angle),\n                cy + ry * Math.sin(angle),\n            ];\n            corePoints.push(p);\n            allPoints.push(p);\n        }\n        allPoints.push([\n            cx + rx * Math.cos(0),\n            cy + ry * Math.sin(0),\n        ]);\n        allPoints.push([\n            cx + rx * Math.cos(increment),\n            cy + ry * Math.sin(increment),\n        ]);\n    }\n    else {\n        const radOffset = _offsetOpt(0.5, o) - (Math.PI / 2);\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + 0.9 * rx * Math.cos(radOffset - increment),\n            _offsetOpt(offset, o) + cy + 0.9 * ry * Math.sin(radOffset - increment),\n        ]);\n        const endAngle = Math.PI * 2 + radOffset - 0.01;\n        for (let angle = radOffset; angle < endAngle; angle = angle + increment) {\n            const p = [\n                _offsetOpt(offset, o) + cx + rx * Math.cos(angle),\n                _offsetOpt(offset, o) + cy + ry * Math.sin(angle),\n            ];\n            corePoints.push(p);\n            allPoints.push(p);\n        }\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + rx * Math.cos(radOffset + Math.PI * 2 + overlap * 0.5),\n            _offsetOpt(offset, o) + cy + ry * Math.sin(radOffset + Math.PI * 2 + overlap * 0.5),\n        ]);\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + 0.98 * rx * Math.cos(radOffset + overlap),\n            _offsetOpt(offset, o) + cy + 0.98 * ry * Math.sin(radOffset + overlap),\n        ]);\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + 0.9 * rx * Math.cos(radOffset + overlap * 0.5),\n            _offsetOpt(offset, o) + cy + 0.9 * ry * Math.sin(radOffset + overlap * 0.5),\n        ]);\n    }\n    return [allPoints, corePoints];\n}\nfunction _arc(increment, cx, cy, rx, ry, strt, stp, offset, o) {\n    const radOffset = strt + _offsetOpt(0.1, o);\n    const points = [];\n    points.push([\n        _offsetOpt(offset, o) + cx + 0.9 * rx * Math.cos(radOffset - increment),\n        _offsetOpt(offset, o) + cy + 0.9 * ry * Math.sin(radOffset - increment),\n    ]);\n    for (let angle = radOffset; angle <= stp; angle = angle + increment) {\n        points.push([\n            _offsetOpt(offset, o) + cx + rx * Math.cos(angle),\n            _offsetOpt(offset, o) + cy + ry * Math.sin(angle),\n        ]);\n    }\n    points.push([\n        cx + rx * Math.cos(stp),\n        cy + ry * Math.sin(stp),\n    ]);\n    points.push([\n        cx + rx * Math.cos(stp),\n        cy + ry * Math.sin(stp),\n    ]);\n    return _curve(points, null, o);\n}\nfunction _bezierTo(x1, y1, x2, y2, x, y, current, o) {\n    const ops = [];\n    const ros = [o.maxRandomnessOffset || 1, (o.maxRandomnessOffset || 1) + 0.3];\n    let f = [0, 0];\n    const iterations = o.disableMultiStroke ? 1 : 2;\n    const preserveVertices = o.preserveVertices;\n    for (let i = 0; i < iterations; i++) {\n        if (i === 0) {\n            ops.push({ op: 'move', data: [current[0], current[1]] });\n        }\n        else {\n            ops.push({ op: 'move', data: [current[0] + (preserveVertices ? 0 : _offsetOpt(ros[0], o)), current[1] + (preserveVertices ? 0 : _offsetOpt(ros[0], o))] });\n        }\n        f = preserveVertices ? [x, y] : [x + _offsetOpt(ros[i], o), y + _offsetOpt(ros[i], o)];\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                x1 + _offsetOpt(ros[i], o), y1 + _offsetOpt(ros[i], o),\n                x2 + _offsetOpt(ros[i], o), y2 + _offsetOpt(ros[i], o),\n                f[0], f[1],\n            ],\n        });\n    }\n    return ops;\n}\n","function clone(p) {\n    return [...p];\n}\nexport function curveToBezier(pointsIn, curveTightness = 0) {\n    const len = pointsIn.length;\n    if (len < 3) {\n        throw new Error('A curve must have at least three points.');\n    }\n    const out = [];\n    if (len === 3) {\n        out.push(clone(pointsIn[0]), clone(pointsIn[1]), clone(pointsIn[2]), clone(pointsIn[2]));\n    }\n    else {\n        const points = [];\n        points.push(pointsIn[0], pointsIn[0]);\n        for (let i = 1; i < pointsIn.length; i++) {\n            points.push(pointsIn[i]);\n            if (i === (pointsIn.length - 1)) {\n                points.push(pointsIn[i]);\n            }\n        }\n        const b = [];\n        const s = 1 - curveTightness;\n        out.push(clone(points[0]));\n        for (let i = 1; (i + 2) < points.length; i++) {\n            const cachedVertArray = points[i];\n            b[0] = [cachedVertArray[0], cachedVertArray[1]];\n            b[1] = [cachedVertArray[0] + (s * points[i + 1][0] - s * points[i - 1][0]) / 6, cachedVertArray[1] + (s * points[i + 1][1] - s * points[i - 1][1]) / 6];\n            b[2] = [points[i + 1][0] + (s * points[i][0] - s * points[i + 2][0]) / 6, points[i + 1][1] + (s * points[i][1] - s * points[i + 2][1]) / 6];\n            b[3] = [points[i + 1][0], points[i + 1][1]];\n            out.push(b[1], b[2], b[3]);\n        }\n    }\n    return out;\n}\n","// distance between 2 points\nfunction distance(p1, p2) {\n    return Math.sqrt(distanceSq(p1, p2));\n}\n// distance between 2 points squared\nfunction distanceSq(p1, p2) {\n    return Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2);\n}\n// Sistance squared from a point p to the line segment vw\nfunction distanceToSegmentSq(p, v, w) {\n    const l2 = distanceSq(v, w);\n    if (l2 === 0) {\n        return distanceSq(p, v);\n    }\n    let t = ((p[0] - v[0]) * (w[0] - v[0]) + (p[1] - v[1]) * (w[1] - v[1])) / l2;\n    t = Math.max(0, Math.min(1, t));\n    return distanceSq(p, lerp(v, w, t));\n}\nfunction lerp(a, b, t) {\n    return [\n        a[0] + (b[0] - a[0]) * t,\n        a[1] + (b[1] - a[1]) * t,\n    ];\n}\n// Adapted from https://seant23.wordpress.com/2010/11/12/offset-bezier-curves/\nfunction flatness(points, offset) {\n    const p1 = points[offset + 0];\n    const p2 = points[offset + 1];\n    const p3 = points[offset + 2];\n    const p4 = points[offset + 3];\n    let ux = 3 * p2[0] - 2 * p1[0] - p4[0];\n    ux *= ux;\n    let uy = 3 * p2[1] - 2 * p1[1] - p4[1];\n    uy *= uy;\n    let vx = 3 * p3[0] - 2 * p4[0] - p1[0];\n    vx *= vx;\n    let vy = 3 * p3[1] - 2 * p4[1] - p1[1];\n    vy *= vy;\n    if (ux < vx) {\n        ux = vx;\n    }\n    if (uy < vy) {\n        uy = vy;\n    }\n    return ux + uy;\n}\nfunction getPointsOnBezierCurveWithSplitting(points, offset, tolerance, newPoints) {\n    const outPoints = newPoints || [];\n    if (flatness(points, offset) < tolerance) {\n        const p0 = points[offset + 0];\n        if (outPoints.length) {\n            const d = distance(outPoints[outPoints.length - 1], p0);\n            if (d > 1) {\n                outPoints.push(p0);\n            }\n        }\n        else {\n            outPoints.push(p0);\n        }\n        outPoints.push(points[offset + 3]);\n    }\n    else {\n        // subdivide\n        const t = .5;\n        const p1 = points[offset + 0];\n        const p2 = points[offset + 1];\n        const p3 = points[offset + 2];\n        const p4 = points[offset + 3];\n        const q1 = lerp(p1, p2, t);\n        const q2 = lerp(p2, p3, t);\n        const q3 = lerp(p3, p4, t);\n        const r1 = lerp(q1, q2, t);\n        const r2 = lerp(q2, q3, t);\n        const red = lerp(r1, r2, t);\n        getPointsOnBezierCurveWithSplitting([p1, q1, r1, red], 0, tolerance, outPoints);\n        getPointsOnBezierCurveWithSplitting([red, r2, q3, p4], 0, tolerance, outPoints);\n    }\n    return outPoints;\n}\nexport function simplify(points, distance) {\n    return simplifyPoints(points, 0, points.length, distance);\n}\n// RamerDouglasPeucker algorithm\n// https://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm\nfunction simplifyPoints(points, start, end, epsilon, newPoints) {\n    const outPoints = newPoints || [];\n    // find the most distance point from the endpoints\n    const s = points[start];\n    const e = points[end - 1];\n    let maxDistSq = 0;\n    let maxNdx = 1;\n    for (let i = start + 1; i < end - 1; ++i) {\n        const distSq = distanceToSegmentSq(points[i], s, e);\n        if (distSq > maxDistSq) {\n            maxDistSq = distSq;\n            maxNdx = i;\n        }\n    }\n    // if that point is too far, split\n    if (Math.sqrt(maxDistSq) > epsilon) {\n        simplifyPoints(points, start, maxNdx + 1, epsilon, outPoints);\n        simplifyPoints(points, maxNdx, end, epsilon, outPoints);\n    }\n    else {\n        if (!outPoints.length) {\n            outPoints.push(s);\n        }\n        outPoints.push(e);\n    }\n    return outPoints;\n}\nexport function pointsOnBezierCurves(points, tolerance = 0.15, distance) {\n    const newPoints = [];\n    const numSegments = (points.length - 1) / 3;\n    for (let i = 0; i < numSegments; i++) {\n        const offset = i * 3;\n        getPointsOnBezierCurveWithSplitting(points, offset, tolerance, newPoints);\n    }\n    if (distance && distance > 0) {\n        return simplifyPoints(newPoints, 0, newPoints.length, distance);\n    }\n    return newPoints;\n}\n","import { line, solidFillPolygon, patternFillPolygons, rectangle, ellipseWithParams, generateEllipseParams, linearPath, arc, patternFillArc, curve, svgPath } from './renderer.js';\nimport { randomSeed } from './math.js';\nimport { curveToBezier } from 'points-on-curve/lib/curve-to-bezier.js';\nimport { pointsOnBezierCurves } from 'points-on-curve';\nimport { pointsOnPath } from 'points-on-path';\nconst NOS = 'none';\nexport class RoughGenerator {\n    constructor(config) {\n        this.defaultOptions = {\n            maxRandomnessOffset: 2,\n            roughness: 1,\n            bowing: 1,\n            stroke: '#000',\n            strokeWidth: 1,\n            curveTightness: 0,\n            curveFitting: 0.95,\n            curveStepCount: 9,\n            fillStyle: 'hachure',\n            fillWeight: -1,\n            hachureAngle: -41,\n            hachureGap: -1,\n            dashOffset: -1,\n            dashGap: -1,\n            zigzagOffset: -1,\n            seed: 0,\n            disableMultiStroke: false,\n            disableMultiStrokeFill: false,\n            preserveVertices: false,\n        };\n        this.config = config || {};\n        if (this.config.options) {\n            this.defaultOptions = this._o(this.config.options);\n        }\n    }\n    static newSeed() {\n        return randomSeed();\n    }\n    _o(options) {\n        return options ? Object.assign({}, this.defaultOptions, options) : this.defaultOptions;\n    }\n    _d(shape, sets, options) {\n        return { shape, sets: sets || [], options: options || this.defaultOptions };\n    }\n    line(x1, y1, x2, y2, options) {\n        const o = this._o(options);\n        return this._d('line', [line(x1, y1, x2, y2, o)], o);\n    }\n    rectangle(x, y, width, height, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = rectangle(x, y, width, height, o);\n        if (o.fill) {\n            const points = [[x, y], [x + width, y], [x + width, y + height], [x, y + height]];\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon([points], o));\n            }\n            else {\n                paths.push(patternFillPolygons([points], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('rectangle', paths, o);\n    }\n    ellipse(x, y, width, height, options) {\n        const o = this._o(options);\n        const paths = [];\n        const ellipseParams = generateEllipseParams(width, height, o);\n        const ellipseResponse = ellipseWithParams(x, y, o, ellipseParams);\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = ellipseWithParams(x, y, o, ellipseParams).opset;\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(patternFillPolygons([ellipseResponse.estimatedPoints], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(ellipseResponse.opset);\n        }\n        return this._d('ellipse', paths, o);\n    }\n    circle(x, y, diameter, options) {\n        const ret = this.ellipse(x, y, diameter, diameter, options);\n        ret.shape = 'circle';\n        return ret;\n    }\n    linearPath(points, options) {\n        const o = this._o(options);\n        return this._d('linearPath', [linearPath(points, false, o)], o);\n    }\n    arc(x, y, width, height, start, stop, closed = false, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = arc(x, y, width, height, start, stop, closed, true, o);\n        if (closed && o.fill) {\n            if (o.fillStyle === 'solid') {\n                const fillOptions = Object.assign({}, o);\n                fillOptions.disableMultiStroke = true;\n                const shape = arc(x, y, width, height, start, stop, true, false, fillOptions);\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(patternFillArc(x, y, width, height, start, stop, o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('arc', paths, o);\n    }\n    curve(points, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = curve(points, o);\n        if (o.fill && o.fill !== NOS && points.length >= 3) {\n            const bcurve = curveToBezier(points);\n            const polyPoints = pointsOnBezierCurves(bcurve, 10, (1 + o.roughness) / 2);\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon([polyPoints], o));\n            }\n            else {\n                paths.push(patternFillPolygons([polyPoints], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('curve', paths, o);\n    }\n    polygon(points, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = linearPath(points, true, o);\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon([points], o));\n            }\n            else {\n                paths.push(patternFillPolygons([points], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('polygon', paths, o);\n    }\n    path(d, options) {\n        const o = this._o(options);\n        const paths = [];\n        if (!d) {\n            return this._d('path', paths, o);\n        }\n        d = (d || '').replace(/\\n/g, ' ').replace(/(-\\s)/g, '-').replace('/(\\s\\s)/g', ' ');\n        const hasFill = o.fill && o.fill !== 'transparent' && o.fill !== NOS;\n        const hasStroke = o.stroke !== NOS;\n        const simplified = !!(o.simplification && (o.simplification < 1));\n        const distance = simplified ? (4 - 4 * (o.simplification)) : ((1 + o.roughness) / 2);\n        const sets = pointsOnPath(d, 1, distance);\n        if (hasFill) {\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon(sets, o));\n            }\n            else {\n                paths.push(patternFillPolygons(sets, o));\n            }\n        }\n        if (hasStroke) {\n            if (simplified) {\n                sets.forEach((set) => {\n                    paths.push(linearPath(set, false, o));\n                });\n            }\n            else {\n                paths.push(svgPath(d, o));\n            }\n        }\n        return this._d('path', paths, o);\n    }\n    opsToPath(drawing, fixedDecimals) {\n        let path = '';\n        for (const item of drawing.ops) {\n            const data = ((typeof fixedDecimals === 'number') && fixedDecimals >= 0) ? (item.data.map((d) => +d.toFixed(fixedDecimals))) : item.data;\n            switch (item.op) {\n                case 'move':\n                    path += `M${data[0]} ${data[1]} `;\n                    break;\n                case 'bcurveTo':\n                    path += `C${data[0]} ${data[1]}, ${data[2]} ${data[3]}, ${data[4]} ${data[5]} `;\n                    break;\n                case 'lineTo':\n                    path += `L${data[0]} ${data[1]} `;\n                    break;\n            }\n        }\n        return path.trim();\n    }\n    toPaths(drawable) {\n        const sets = drawable.sets || [];\n        const o = drawable.options || this.defaultOptions;\n        const paths = [];\n        for (const drawing of sets) {\n            let path = null;\n            switch (drawing.type) {\n                case 'path':\n                    path = {\n                        d: this.opsToPath(drawing),\n                        stroke: o.stroke,\n                        strokeWidth: o.strokeWidth,\n                        fill: NOS,\n                    };\n                    break;\n                case 'fillPath':\n                    path = {\n                        d: this.opsToPath(drawing),\n                        stroke: NOS,\n                        strokeWidth: 0,\n                        fill: o.fill || NOS,\n                    };\n                    break;\n                case 'fillSketch':\n                    path = this.fillSketch(drawing, o);\n                    break;\n            }\n            if (path) {\n                paths.push(path);\n            }\n        }\n        return paths;\n    }\n    fillSketch(drawing, o) {\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        return {\n            d: this.opsToPath(drawing),\n            stroke: o.fill || NOS,\n            strokeWidth: fweight,\n            fill: NOS,\n        };\n    }\n}\n","import { pointsOnBezierCurves, simplify } from 'points-on-curve';\nimport { parsePath, absolutize, normalize } from 'path-data-parser';\nexport function pointsOnPath(path, tolerance, distance) {\n    const segments = parsePath(path);\n    const normalized = normalize(absolutize(segments));\n    const sets = [];\n    let currentPoints = [];\n    let start = [0, 0];\n    let pendingCurve = [];\n    const appendPendingCurve = () => {\n        if (pendingCurve.length >= 4) {\n            currentPoints.push(...pointsOnBezierCurves(pendingCurve, tolerance));\n        }\n        pendingCurve = [];\n    };\n    const appendPendingPoints = () => {\n        appendPendingCurve();\n        if (currentPoints.length) {\n            sets.push(currentPoints);\n            currentPoints = [];\n        }\n    };\n    for (const { key, data } of normalized) {\n        switch (key) {\n            case 'M':\n                appendPendingPoints();\n                start = [data[0], data[1]];\n                currentPoints.push(start);\n                break;\n            case 'L':\n                appendPendingCurve();\n                currentPoints.push([data[0], data[1]]);\n                break;\n            case 'C':\n                if (!pendingCurve.length) {\n                    const lastPoint = currentPoints.length ? currentPoints[currentPoints.length - 1] : start;\n                    pendingCurve.push([lastPoint[0], lastPoint[1]]);\n                }\n                pendingCurve.push([data[0], data[1]]);\n                pendingCurve.push([data[2], data[3]]);\n                pendingCurve.push([data[4], data[5]]);\n                break;\n            case 'Z':\n                appendPendingCurve();\n                currentPoints.push([start[0], start[1]]);\n                break;\n        }\n    }\n    appendPendingPoints();\n    if (!distance) {\n        return sets;\n    }\n    const out = [];\n    for (const set of sets) {\n        const simplifiedSet = simplify(set, distance);\n        if (simplifiedSet.length) {\n            out.push(simplifiedSet);\n        }\n    }\n    return out;\n}\n","import { RoughGenerator } from './generator';\nexport class RoughCanvas {\n    constructor(canvas, config) {\n        this.canvas = canvas;\n        this.ctx = this.canvas.getContext('2d');\n        this.gen = new RoughGenerator(config);\n    }\n    draw(drawable) {\n        const sets = drawable.sets || [];\n        const o = drawable.options || this.getDefaultOptions();\n        const ctx = this.ctx;\n        const precision = drawable.options.fixedDecimalPlaceDigits;\n        for (const drawing of sets) {\n            switch (drawing.type) {\n                case 'path':\n                    ctx.save();\n                    ctx.strokeStyle = o.stroke === 'none' ? 'transparent' : o.stroke;\n                    ctx.lineWidth = o.strokeWidth;\n                    if (o.strokeLineDash) {\n                        ctx.setLineDash(o.strokeLineDash);\n                    }\n                    if (o.strokeLineDashOffset) {\n                        ctx.lineDashOffset = o.strokeLineDashOffset;\n                    }\n                    this._drawToContext(ctx, drawing, precision);\n                    ctx.restore();\n                    break;\n                case 'fillPath': {\n                    ctx.save();\n                    ctx.fillStyle = o.fill || '';\n                    const fillRule = (drawable.shape === 'curve' || drawable.shape === 'polygon' || drawable.shape === 'path') ? 'evenodd' : 'nonzero';\n                    this._drawToContext(ctx, drawing, precision, fillRule);\n                    ctx.restore();\n                    break;\n                }\n                case 'fillSketch':\n                    this.fillSketch(ctx, drawing, o);\n                    break;\n            }\n        }\n    }\n    fillSketch(ctx, drawing, o) {\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        ctx.save();\n        if (o.fillLineDash) {\n            ctx.setLineDash(o.fillLineDash);\n        }\n        if (o.fillLineDashOffset) {\n            ctx.lineDashOffset = o.fillLineDashOffset;\n        }\n        ctx.strokeStyle = o.fill || '';\n        ctx.lineWidth = fweight;\n        this._drawToContext(ctx, drawing, o.fixedDecimalPlaceDigits);\n        ctx.restore();\n    }\n    _drawToContext(ctx, drawing, fixedDecimals, rule = 'nonzero') {\n        ctx.beginPath();\n        for (const item of drawing.ops) {\n            const data = ((typeof fixedDecimals === 'number') && fixedDecimals >= 0) ? (item.data.map((d) => +d.toFixed(fixedDecimals))) : item.data;\n            switch (item.op) {\n                case 'move':\n                    ctx.moveTo(data[0], data[1]);\n                    break;\n                case 'bcurveTo':\n                    ctx.bezierCurveTo(data[0], data[1], data[2], data[3], data[4], data[5]);\n                    break;\n                case 'lineTo':\n                    ctx.lineTo(data[0], data[1]);\n                    break;\n            }\n        }\n        if (drawing.type === 'fillPath') {\n            ctx.fill(rule);\n        }\n        else {\n            ctx.stroke();\n        }\n    }\n    get generator() {\n        return this.gen;\n    }\n    getDefaultOptions() {\n        return this.gen.defaultOptions;\n    }\n    line(x1, y1, x2, y2, options) {\n        const d = this.gen.line(x1, y1, x2, y2, options);\n        this.draw(d);\n        return d;\n    }\n    rectangle(x, y, width, height, options) {\n        const d = this.gen.rectangle(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    ellipse(x, y, width, height, options) {\n        const d = this.gen.ellipse(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    circle(x, y, diameter, options) {\n        const d = this.gen.circle(x, y, diameter, options);\n        this.draw(d);\n        return d;\n    }\n    linearPath(points, options) {\n        const d = this.gen.linearPath(points, options);\n        this.draw(d);\n        return d;\n    }\n    polygon(points, options) {\n        const d = this.gen.polygon(points, options);\n        this.draw(d);\n        return d;\n    }\n    arc(x, y, width, height, start, stop, closed = false, options) {\n        const d = this.gen.arc(x, y, width, height, start, stop, closed, options);\n        this.draw(d);\n        return d;\n    }\n    curve(points, options) {\n        const d = this.gen.curve(points, options);\n        this.draw(d);\n        return d;\n    }\n    path(d, options) {\n        const drawing = this.gen.path(d, options);\n        this.draw(drawing);\n        return drawing;\n    }\n}\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// Entry point for the notebook bundle containing custom model definitions.\n//\n// Setup notebook base URL\n//\n// Some static assets may be required by the custom widget javascript. The base\n// url for the notebook is not known at build time and is therefore computed\n// dynamically.\n(window as any).__webpack_public_path__ =\n  document.querySelector('body')!.getAttribute('data-base-url') +\n  'nbextensions/ipycanvas';\n\nexport * from './index';\n","// Copyright (c) Martin Renou\n// Distributed under the terms of the Modified BSD License.\n\nexport * from './version';\nexport * from './widget';\n","export function getTypedArray(dataview: any, metadata: any) {\n  switch (metadata.dtype) {\n    case 'int8':\n      return new Int8Array(dataview.buffer);\n      break;\n    case 'uint8':\n      return new Uint8Array(dataview.buffer);\n      break;\n    case 'int16':\n      return new Int16Array(dataview.buffer);\n      break;\n    case 'uint16':\n      return new Uint16Array(dataview.buffer);\n      break;\n    case 'int32':\n      return new Int32Array(dataview.buffer);\n      break;\n    case 'uint32':\n      return new Uint32Array(dataview.buffer);\n      break;\n    case 'float32':\n      return new Float32Array(dataview.buffer);\n      break;\n    case 'float64':\n      return new Float64Array(dataview.buffer);\n      break;\n    default:\n      throw 'Unknown dtype ' + metadata.dtype;\n      break;\n  }\n}\n\n// Scalar type\ntype Scalar = null | boolean | number | string;\n\nnamespace Scalar {\n  export function isScalar(x: any): x is Scalar {\n    return (\n      x === null ||\n      typeof x === 'boolean' ||\n      typeof x === 'number' ||\n      typeof x === 'string'\n    );\n  }\n}\n\ntype TypedArray =\n  | Int8Array\n  | Uint8Array\n  | Int16Array\n  | Uint16Array\n  | Int32Array\n  | Uint32Array\n  | Uint8ClampedArray\n  | Float32Array\n  | Float64Array;\n\n// Buffered argument\nexport abstract class Arg {\n  abstract getItem(idx: number): any;\n\n  length: number;\n}\n\nclass ScalarArg extends Arg {\n  constructor(value: Scalar) {\n    super();\n\n    this.value = value;\n    this.length = Infinity;\n  }\n\n  getItem(idx: number): any {\n    return this.value;\n  }\n\n  value: Scalar;\n}\n\nclass BufferArg extends Arg {\n  constructor(bufferMetadata: any, buffer: any[]) {\n    super();\n\n    this.value = getTypedArray(buffer, bufferMetadata);\n    this.length = this.value.length;\n  }\n\n  getItem(idx: number): any {\n    return this.value[idx];\n  }\n\n  value: TypedArray;\n}\n\nexport function getArg(metadata: any, buffers: any): Arg {\n  if (Scalar.isScalar(metadata)) {\n    return new ScalarArg(metadata);\n  }\n\n  if (metadata['idx'] !== undefined) {\n    return new BufferArg(metadata, buffers[metadata['idx']]);\n  }\n\n  throw 'Could not process argument ' + metadata;\n}\n\nexport async function toBlob(canvas: HTMLCanvasElement): Promise<Blob> {\n  return new Promise<Blob>((resolve, reject) => {\n    canvas.toBlob(blob => {\n      if (blob == null) {\n        return reject('Unable to create blob');\n      }\n\n      resolve(blob);\n    });\n  });\n}\n\nexport async function toBytes(\n  canvas: HTMLCanvasElement\n): Promise<Uint8ClampedArray> {\n  const blob = await toBlob(canvas);\n\n  return new Promise<Uint8ClampedArray>((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onloadend = () => {\n      if (typeof reader.result == 'string' || reader.result == null) {\n        return reject('Unable to read blob');\n      }\n\n      const bytes = new Uint8ClampedArray(reader.result);\n      resolve(bytes);\n    };\n    reader.readAsArrayBuffer(blob);\n  });\n}\n\nexport async function fromBytes(\n  array: Uint8ClampedArray\n): Promise<HTMLImageElement> {\n  const blob = new Blob([array]);\n\n  return new Promise<HTMLImageElement>((resolve, reject) => {\n    const img = new Image();\n\n    img.onload = () => {\n      resolve(img);\n    };\n\n    img.src = URL.createObjectURL(blob);\n  });\n}\n\nexport async function bufferToImage(buffer: any): Promise<HTMLImageElement> {\n  let url: string;\n\n  const blob = new Blob([buffer], { type: 'image/jpeg' });\n  url = URL.createObjectURL(blob);\n\n  const img = new Image();\n  return new Promise(resolve => {\n    img.onload = () => {\n      resolve(img);\n    };\n    img.src = url;\n  });\n}\n","// Copyright (c) Martin Renou\n// Distributed under the terms of the Modified BSD License.\n\nconst data = require('../package.json');\n\n/**\n * The _model_module_version/_view_module_version this package implements.\n *\n * The html widget manager assumes that this is the same as the npm package\n * version number.\n */\nexport const MODULE_VERSION = data.version;\n\n/*\n * The current package name.\n */\nexport const MODULE_NAME = data.name;\n","// Copyright (c) Martin Renou\n// Distributed under the terms of the Modified BSD License.\n\nimport { Buffer } from 'buffer';\n\nimport {\n  DOMWidgetModel,\n  DOMWidgetView,\n  WidgetModel,\n  ISerializers,\n  Dict,\n  unpack_models\n} from '@jupyter-widgets/base';\n\nimport { RoughCanvas } from 'roughjs/bin/canvas';\n\nimport { MODULE_NAME, MODULE_VERSION } from './version';\n\nimport {\n  getArg,\n  toBytes,\n  fromBytes,\n  getTypedArray,\n  bufferToImage\n} from './utils';\n\nfunction getContext(canvas: HTMLCanvasElement) {\n  const context = canvas.getContext('2d');\n  if (context === null) {\n    throw 'Could not create 2d context.';\n  }\n  return context;\n}\n\nfunction serializeImageData(array: Uint8ClampedArray) {\n  return new DataView(array.buffer.slice(0));\n}\n\nfunction deserializeImageData(dataview: DataView | null) {\n  if (dataview === null) {\n    return null;\n  }\n\n  return new Uint8ClampedArray(dataview.buffer);\n}\n\nasync function createImageFromWidget(\n  image: DOMWidgetModel\n): Promise<HTMLImageElement> {\n  // Create the image manually instead of creating an ImageView\n  let url: string;\n  const format = image.get('format');\n  const value = image.get('value');\n  if (format !== 'url') {\n    const blob = new Blob([value], { type: `image/${format}` });\n    url = URL.createObjectURL(blob);\n  } else {\n    url = new TextDecoder('utf-8').decode(value.buffer);\n  }\n\n  const img = new Image();\n  return new Promise(resolve => {\n    img.onload = () => {\n      resolve(img);\n    };\n    img.src = url;\n  });\n}\n\nconst COMMANDS = [\n  'fillRect',\n  'strokeRect',\n  'fillRects',\n  'strokeRects',\n  'clearRect',\n  'fillArc',\n  'fillCircle',\n  'strokeArc',\n  'strokeCircle',\n  'fillArcs',\n  'strokeArcs',\n  'fillCircles',\n  'strokeCircles',\n  'strokeLine',\n  'beginPath',\n  'closePath',\n  'stroke',\n  'fillPath',\n  'fill',\n  'moveTo',\n  'lineTo',\n  'rect',\n  'arc',\n  'ellipse',\n  'arcTo',\n  'quadraticCurveTo',\n  'bezierCurveTo',\n  'fillText',\n  'strokeText',\n  'setLineDash',\n  'drawImage',\n  'putImageData',\n  'clip',\n  'save',\n  'restore',\n  'translate',\n  'rotate',\n  'scale',\n  'transform',\n  'setTransform',\n  'resetTransform',\n  'set',\n  'clear',\n  'sleep',\n  'fillPolygon',\n  'strokePolygon',\n  'strokeLines',\n  'fillPolygons',\n  'strokePolygons',\n  'strokeLineSegments',\n  'fillStyledRects',\n  'strokeStyledRects',\n  'fillStyledCircles',\n  'strokeStyledCircles',\n  'fillStyledArcs',\n  'strokeStyledArcs',\n  'fillStyledPolygons',\n  'strokeStyledPolygons',\n  'strokeStyledLineSegments',\n  'switchCanvas'\n];\n\nexport class CanvasManagerModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: CanvasManagerModel.model_name,\n      _model_module: CanvasManagerModel.model_module,\n      _model_module_version: CanvasManagerModel.model_module_version\n    };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.on('msg:custom', (command: any, buffers: any) => {\n      this.currentProcessing = this.currentProcessing.then(async () => {\n        await this.onCommand(command, buffers);\n      });\n    });\n  }\n\n  private async onCommand(command: any, buffers: any) {\n    // Retrieve the commands buffer as an object (list of commands)\n    const commands = JSON.parse(\n      Buffer.from(getTypedArray(buffers[0], command)).toString('utf-8')\n    );\n\n    this.canvasesToUpdate =\n      this.currentCanvas !== undefined ? [this.currentCanvas] : [];\n\n    await this.processCommand(commands, buffers.slice(1, buffers.length));\n\n    for (const canvas of this.canvasesToUpdate) {\n      canvas.syncViews();\n    }\n  }\n\n  private async processCommand(command: any, buffers: any) {\n    // If it's a list of commands\n    if (command instanceof Array && command[0] instanceof Array) {\n      let remainingBuffers = buffers;\n\n      for (const subcommand of command) {\n        let subbuffers = [];\n        const nBuffers: Number = subcommand[2];\n        if (nBuffers) {\n          subbuffers = remainingBuffers.slice(0, nBuffers);\n          remainingBuffers = remainingBuffers.slice(nBuffers);\n        }\n        await this.processCommand(subcommand, subbuffers);\n      }\n      return;\n    }\n\n    const name: string = COMMANDS[command[0]];\n    const args: any[] = command[1];\n    switch (name) {\n      case 'switchCanvas':\n        await this.switchCanvas(args[0]);\n        this.canvasesToUpdate.push(this.currentCanvas);\n        break;\n      case 'sleep':\n        await this.currentCanvas.sleep(args[0]);\n        break;\n      case 'fillRect':\n        this.currentCanvas.fillRect(args[0], args[1], args[2], args[3]);\n        break;\n      case 'strokeRect':\n        this.currentCanvas.strokeRect(args[0], args[1], args[2], args[3]);\n        break;\n      case 'fillRects':\n        this.currentCanvas.drawRects(\n          args,\n          buffers,\n          this.currentCanvas.fillRect.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeRects':\n        this.currentCanvas.drawRects(\n          args,\n          buffers,\n          this.currentCanvas.strokeRect.bind(this.currentCanvas)\n        );\n        break;\n      case 'fillArc':\n        this.currentCanvas.fillArc(\n          args[0],\n          args[1],\n          args[2],\n          args[3],\n          args[4],\n          args[5]\n        );\n        break;\n      case 'strokeArc':\n        this.currentCanvas.strokeArc(\n          args[0],\n          args[1],\n          args[2],\n          args[3],\n          args[4],\n          args[5]\n        );\n        break;\n      case 'fillArcs':\n        this.currentCanvas.drawArcs(\n          args,\n          buffers,\n          this.currentCanvas.fillArc.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeArcs':\n        this.currentCanvas.drawArcs(\n          args,\n          buffers,\n          this.currentCanvas.strokeArc.bind(this.currentCanvas)\n        );\n        break;\n      case 'fillCircle':\n        this.currentCanvas.fillCircle(args[0], args[1], args[2]);\n        break;\n      case 'strokeCircle':\n        this.currentCanvas.strokeCircle(args[0], args[1], args[2]);\n        break;\n      case 'fillCircles':\n        this.currentCanvas.drawCircles(\n          args,\n          buffers,\n          this.currentCanvas.fillCircle.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeCircles':\n        this.currentCanvas.drawCircles(\n          args,\n          buffers,\n          this.currentCanvas.strokeCircle.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeLine':\n        this.currentCanvas.strokeLine(args, buffers);\n        break;\n      case 'strokeLines':\n        this.currentCanvas.strokeLines(args, buffers);\n        break;\n      case 'fillPolygon':\n        this.currentCanvas.fillPolygon(args, buffers);\n        break;\n      case 'strokePolygon':\n        this.currentCanvas.strokePolygon(args, buffers);\n        break;\n      case 'fillPath':\n        await this.currentCanvas.fillPath(args, buffers);\n        break;\n      case 'drawImage':\n        await this.currentCanvas.drawImage(args, buffers);\n        break;\n      case 'putImageData':\n        await this.currentCanvas.putImageData(args, buffers);\n        break;\n      case 'set':\n        await this.currentCanvas.setAttr(args[0], args[1]);\n        break;\n      case 'clear':\n        this.currentCanvas.clearCanvas();\n        break;\n      case 'fillPolygons':\n        this.currentCanvas.drawPolygonOrLineSegments(args, buffers, true, true);\n        break;\n      case 'strokePolygons':\n        this.currentCanvas.drawPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          true\n        );\n        break;\n      case 'strokeLineSegments':\n        this.currentCanvas.drawPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          false\n        );\n        break;\n      case 'fillStyledRects':\n        this.currentCanvas.drawStyledRects(args, buffers, true);\n        break;\n      case 'strokeStyledRects':\n        this.currentCanvas.drawStyledRects(args, buffers, false);\n        break;\n      case 'fillStyledCircles':\n        this.currentCanvas.drawStyledCircles(args, buffers, true);\n        break;\n      case 'strokeStyledCircles':\n        this.currentCanvas.drawStyledCircles(args, buffers, false);\n        break;\n      case 'fillStyledArcs':\n        this.currentCanvas.drawStyledArcs(args, buffers, true);\n        break;\n      case 'strokeStyledArcs':\n        this.currentCanvas.drawStyledArcs(args, buffers, false);\n        break;\n      case 'fillStyledPolygons':\n        this.currentCanvas.drawStyledPolygonOrLineSegments(\n          args,\n          buffers,\n          true,\n          true\n        );\n        break;\n      case 'strokeStyledPolygons':\n        this.currentCanvas.drawStyledPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          true\n        );\n        break;\n      case 'strokeStyledLineSegments':\n        this.currentCanvas.drawStyledPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          false\n        );\n        break;\n      default:\n        this.currentCanvas.executeCommand(name, args);\n        break;\n    }\n  }\n\n  private async switchCanvas(serializedCanvas: any) {\n    this.currentCanvas = await unpack_models(\n      serializedCanvas,\n      this.widget_manager\n    );\n  }\n\n  private currentCanvas: CanvasModel;\n  private currentProcessing: Promise<void> = Promise.resolve();\n  private canvasesToUpdate: CanvasModel[] = [];\n\n  static model_name = 'CanvasManagerModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n}\n\nexport class Path2DModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: Path2DModel.model_name,\n      _model_module: Path2DModel.model_module,\n      _model_module_version: Path2DModel.model_module_version,\n      value: ''\n    };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.value = new Path2D(this.get('value'));\n  }\n\n  value: Path2D;\n\n  static model_name = 'Path2DModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n}\n\nexport class PatternModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: PatternModel.model_name,\n      _model_module: PatternModel.model_module,\n      _model_module_version: PatternModel.model_module_version,\n      image: '',\n      repetition: 'repeat'\n    };\n  }\n\n  async initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    const image = this.get('image');\n    let patternSource: HTMLCanvasElement | HTMLImageElement | undefined =\n      undefined;\n\n    if (image instanceof CanvasModel || image instanceof MultiCanvasModel) {\n      patternSource = image.canvas;\n    }\n\n    if (image.get('_model_name') == 'ImageModel') {\n      const img = await createImageFromWidget(image);\n      patternSource = img;\n    }\n\n    if (patternSource == undefined) {\n      throw 'Could not understand the souce for the pattern';\n    }\n\n    const pattern = PatternModel.ctx.createPattern(\n      patternSource,\n      this.get('repetition')\n    );\n\n    if (pattern == null) {\n      throw 'Could not initialize pattern object';\n    }\n\n    this.value = pattern;\n  }\n\n  static serializers: ISerializers = {\n    ...WidgetModel.serializers,\n    image: { deserialize: unpack_models as any }\n  };\n\n  value: CanvasPattern;\n\n  static model_name = 'PatternModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n\n  // Global context for creating the gradients\n  static ctx: CanvasRenderingContext2D = getContext(\n    document.createElement('canvas')\n  );\n}\n\nclass GradientModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_module: GradientModel.model_module,\n      _model_module_version: GradientModel.model_module_version,\n      x0: 0,\n      y0: 0,\n      x1: 0,\n      y1: 0,\n      color_stops: []\n    };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.createGradient();\n\n    for (const colorStop of this.get('color_stops')) {\n      this.value.addColorStop(colorStop[0], colorStop[1]);\n    }\n  }\n\n  protected createGradient() {\n    this.value = GradientModel.ctx.createLinearGradient(\n      this.get('x0'),\n      this.get('y0'),\n      this.get('x1'),\n      this.get('y1')\n    );\n  }\n\n  value: CanvasGradient;\n\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n\n  // Global context for creating the gradients\n  static ctx: CanvasRenderingContext2D = getContext(\n    document.createElement('canvas')\n  );\n}\n\nexport class LinearGradientModel extends GradientModel {\n  defaults() {\n    return { ...super.defaults(), _model_name: LinearGradientModel.model_name };\n  }\n\n  static model_name = 'LinearGradientModel';\n}\n\nexport class RadialGradientModel extends GradientModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: RadialGradientModel.model_name,\n      r0: 0,\n      r1: 0\n    };\n  }\n\n  protected createGradient() {\n    this.value = GradientModel.ctx.createRadialGradient(\n      this.get('x0'),\n      this.get('y0'),\n      this.get('r0'),\n      this.get('x1'),\n      this.get('y1'),\n      this.get('r1')\n    );\n  }\n\n  static model_name = 'RadialGradientModel';\n}\n\nexport class CanvasModel extends DOMWidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: CanvasModel.model_name,\n      _model_module: CanvasModel.model_module,\n      _model_module_version: CanvasModel.model_module_version,\n      _view_name: CanvasModel.view_name,\n      _view_module: CanvasModel.view_module,\n      _view_module_version: CanvasModel.view_module_version,\n      width: 700,\n      height: 500,\n      sync_image_data: false,\n      image_data: null,\n      _send_client_ready_event: true\n    };\n  }\n\n  static serializers: ISerializers = {\n    ...DOMWidgetModel.serializers,\n    image_data: {\n      serialize: serializeImageData,\n      deserialize: deserializeImageData\n    }\n  };\n\n  static ATTRS = [\n    'fillStyle',\n    'strokeStyle',\n    'globalAlpha',\n    'font',\n    'textAlign',\n    'textBaseline',\n    'direction',\n    'globalCompositeOperation',\n    'lineWidth',\n    'lineCap',\n    'lineJoin',\n    'miterLimit',\n    'lineDashOffset',\n    'shadowOffsetX',\n    'shadowOffsetY',\n    'shadowBlur',\n    'shadowColor',\n    'filter'\n  ];\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.canvas = document.createElement('canvas');\n    this.ctx = getContext(this.canvas);\n\n    this.resizeCanvas();\n    this.drawImageData();\n\n    this.on_some_change(['width', 'height'], this.resizeCanvas, this);\n    this.on('change:sync_image_data', this.syncImageData.bind(this));\n    // this.on('msg:custom', this.onCommand.bind(this));\n\n    if (this.get('_send_client_ready_event')) {\n      this.send({ event: 'client_ready' }, {});\n    }\n  }\n\n  private async drawImageData() {\n    if (this.get('image_data') !== null) {\n      const img = await fromBytes(this.get('image_data'));\n\n      this.ctx.drawImage(img, 0, 0);\n\n      this.trigger('new-frame');\n    }\n  }\n\n  async syncViews() {\n    this.forEachView((view: CanvasView) => {\n      view.updateCanvas();\n    });\n\n    this.trigger('new-frame');\n    this.syncImageData();\n  }\n\n  async sleep(time: number) {\n    this.forEachView((view: CanvasView) => {\n      view.updateCanvas();\n    });\n\n    this.trigger('new-frame');\n    this.syncImageData();\n\n    await new Promise(resolve => setTimeout(resolve, time));\n  }\n\n  fillRect(x: number, y: number, width: number, height: number) {\n    this.ctx.fillRect(x, y, width, height);\n  }\n\n  strokeRect(x: number, y: number, width: number, height: number) {\n    this.ctx.strokeRect(x, y, width, height);\n  }\n\n  drawRects(\n    args: any[],\n    buffers: any,\n    callback: (x: number, y: number, width: number, height: number) => void\n  ) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const width = getArg(args[2], buffers);\n    const height = getArg(args[3], buffers);\n\n    const numberRects = Math.min(\n      x.length,\n      y.length,\n      width.length,\n      height.length\n    );\n\n    for (let idx = 0; idx < numberRects; ++idx) {\n      callback(\n        x.getItem(idx),\n        y.getItem(idx),\n        width.getItem(idx),\n        height.getItem(idx)\n      );\n    }\n  }\n\n  drawStyledRects(args: any[], buffers: any, fill: boolean) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const width = getArg(args[2], buffers);\n    const height = getArg(args[3], buffers);\n    const colors = getArg(args[4], buffers);\n    const alpha = getArg(args[5], buffers);\n\n    const numberRects = Math.min(\n      x.length,\n      y.length,\n      width.length,\n      height.length\n    );\n\n    this.ctx.save();\n    for (let idx = 0; idx < numberRects; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n      if (fill) {\n        this.fillRect(\n          x.getItem(idx),\n          y.getItem(idx),\n          width.getItem(idx),\n          height.getItem(idx)\n        );\n      } else {\n        this.strokeRect(\n          x.getItem(idx),\n          y.getItem(idx),\n          width.getItem(idx),\n          height.getItem(idx)\n        );\n      }\n    }\n    this.ctx.restore();\n  }\n\n  fillArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    this.ctx.beginPath();\n\n    this.ctx.moveTo(x, y); // Move to center\n    this.ctx.lineTo(\n      x + radius * Math.cos(startAngle),\n      y + radius * Math.sin(startAngle)\n    ); // Line to beginning of the arc\n    this.ctx.arc(x, y, radius, startAngle, endAngle, anticlockwise);\n    this.ctx.lineTo(x, y); // Line to center\n    this.ctx.fill();\n\n    this.ctx.closePath();\n  }\n\n  strokeArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    this.ctx.beginPath();\n\n    this.ctx.arc(x, y, radius, startAngle, endAngle, anticlockwise);\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  drawArcs(\n    args: any[],\n    buffers: any,\n    callback: (\n      x: number,\n      y: number,\n      radius: number,\n      startAngle: number,\n      endAngle: number,\n      anticlockwise: boolean\n    ) => void\n  ) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n    const startAngle = getArg(args[3], buffers);\n    const endAngle = getArg(args[4], buffers);\n    const anticlockwise = getArg(args[5], buffers);\n\n    const numberArcs = Math.min(\n      x.length,\n      y.length,\n      radius.length,\n      startAngle.length,\n      endAngle.length\n    );\n\n    for (let idx = 0; idx < numberArcs; ++idx) {\n      callback(\n        x.getItem(idx),\n        y.getItem(idx),\n        radius.getItem(idx),\n        startAngle.getItem(idx),\n        endAngle.getItem(idx),\n        anticlockwise.getItem(idx)\n      );\n    }\n  }\n\n  fillCircle(x: number, y: number, radius: number) {\n    this.ctx.beginPath();\n    this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\n    this.ctx.fill();\n\n    this.ctx.closePath();\n  }\n\n  strokeCircle(x: number, y: number, radius: number) {\n    this.ctx.beginPath();\n    this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  drawCircles(\n    args: any[],\n    buffers: any,\n    callback: (x: number, y: number, radius: number) => void\n  ) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n\n    const numberCircles = Math.min(x.length, y.length, radius.length);\n\n    for (let idx = 0; idx < numberCircles; ++idx) {\n      callback(x.getItem(idx), y.getItem(idx), radius.getItem(idx));\n    }\n  }\n\n  setStyle(style: any, fill: boolean) {\n    if (fill) {\n      this.ctx.fillStyle = style;\n    } else {\n      this.ctx.strokeStyle = style;\n    }\n  }\n\n  drawStyledCircles(args: any[], buffers: any, fill: boolean) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n    const colors = getArg(args[3], buffers);\n    const alpha = getArg(args[4], buffers);\n\n    const numberCircles = Math.min(x.length, y.length, radius.length);\n    this.ctx.save();\n    for (let idx = 0; idx < numberCircles; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n      if (fill) {\n        this.fillCircle(x.getItem(idx), y.getItem(idx), radius.getItem(idx));\n      } else {\n        this.strokeCircle(x.getItem(idx), y.getItem(idx), radius.getItem(idx));\n      }\n    }\n    this.ctx.restore();\n  }\n\n  drawStyledArcs(args: any[], buffers: any, fill: boolean) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n    const startAngle = getArg(args[3], buffers);\n    const endAngle = getArg(args[4], buffers);\n    const anticlockwise = getArg(args[5], buffers);\n    const colors = getArg(args[6], buffers);\n    const alpha = getArg(args[7], buffers);\n\n    const numberArcs = Math.min(\n      x.length,\n      y.length,\n      radius.length,\n      startAngle.length,\n      endAngle.length\n    );\n\n    this.ctx.save();\n    for (let idx = 0; idx < numberArcs; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n      if (fill) {\n        this.fillArc(\n          x.getItem(idx),\n          y.getItem(idx),\n          radius.getItem(idx),\n          startAngle.getItem(idx),\n          endAngle.getItem(idx),\n          anticlockwise.getItem(idx)\n        );\n      } else {\n        this.strokeArc(\n          x.getItem(idx),\n          y.getItem(idx),\n          radius.getItem(idx),\n          startAngle.getItem(idx),\n          endAngle.getItem(idx),\n          anticlockwise.getItem(idx)\n        );\n      }\n    }\n    this.ctx.restore();\n  }\n\n  drawStyledPolygonOrLineSegments(\n    args: any[],\n    buffers: any,\n    fill: boolean,\n    close: boolean\n  ) {\n    const numPolygons = args[0];\n    const points = getArg(args[1], buffers);\n    const sizes = getArg(args[2], buffers);\n    const colors = getArg(args[3], buffers);\n    const alpha = getArg(args[4], buffers);\n\n    this.ctx.save();\n\n    let start = 0;\n    for (let idx = 0; idx < numPolygons; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n\n      // start / stop in the points array fr this polygon\n      const size = sizes.getItem(idx) * 2;\n      const stop = start + size;\n\n      // Move to the first point, then create lines between points\n      this.ctx.beginPath();\n      this.ctx.moveTo(points.getItem(start), points.getItem(start + 1));\n\n      // draw all points of the polygon (except start)\n      for (let idp = start + 2; idp < stop; idp += 2) {\n        this.ctx.lineTo(points.getItem(idp), points.getItem(idp + 1));\n      }\n      start = stop;\n      if (close) {\n        this.ctx.closePath();\n      }\n      fill ? this.ctx.fill() : this.ctx.stroke();\n    }\n    this.ctx.restore();\n  }\n\n  drawPolygonOrLineSegments(\n    args: any[],\n    buffers: any,\n    fill: boolean,\n    close: boolean\n  ) {\n    const numPolygons = args[0];\n    const points = getArg(args[1], buffers);\n    const sizes = getArg(args[2], buffers);\n\n    let start = 0;\n    for (let idx = 0; idx < numPolygons; ++idx) {\n      // start / stop in the points array fr this polygon\n      const size = sizes.getItem(idx) * 2;\n      const stop = start + size;\n\n      // Move to the first point, then create lines between points\n      this.ctx.beginPath();\n      this.ctx.moveTo(points.getItem(start), points.getItem(start + 1));\n\n      // draw all points of the polygon (except start)\n      for (let idp = start + 2; idp < stop; idp += 2) {\n        this.ctx.lineTo(points.getItem(idp), points.getItem(idp + 1));\n      }\n      start = stop;\n      if (close) {\n        this.ctx.closePath();\n      }\n      fill ? this.ctx.fill() : this.ctx.stroke();\n    }\n  }\n\n  strokeLine(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    this.ctx.moveTo(args[0], args[1]);\n    this.ctx.lineTo(args[2], args[3]);\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  strokeLines(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    const points = getArg(args[0], buffers);\n\n    // Move to the first point, then create lines between points\n    this.ctx.moveTo(points.getItem(0), points.getItem(1));\n    for (let idx = 2; idx < points.length; idx += 2) {\n      this.ctx.lineTo(points.getItem(idx), points.getItem(idx + 1));\n    }\n\n    this.ctx.stroke();\n    this.ctx.closePath();\n  }\n\n  fillPolygon(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    const points = getArg(args[0], buffers);\n\n    // Move to the first point, then create lines between points\n    this.ctx.moveTo(points.getItem(0), points.getItem(1));\n    for (let idx = 2; idx < points.length; idx += 2) {\n      this.ctx.lineTo(points.getItem(idx), points.getItem(idx + 1));\n    }\n\n    this.ctx.closePath();\n    this.ctx.fill();\n  }\n\n  strokePolygon(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    const points = getArg(args[0], buffers);\n\n    // Move to the first point, then create lines between points\n    this.ctx.moveTo(points.getItem(0), points.getItem(1));\n    for (let idx = 2; idx < points.length; idx += 2) {\n      this.ctx.lineTo(points.getItem(idx), points.getItem(idx + 1));\n    }\n\n    this.ctx.closePath();\n    this.ctx.stroke();\n  }\n\n  async fillPath(args: any[], buffers: any) {\n    const [serializedPath] = args;\n\n    const path = await unpack_models(serializedPath, this.widget_manager);\n\n    this.ctx.fill(path.value);\n  }\n\n  async drawImage(args: any[], buffers: any) {\n    const [serializedImage, x, y, width, height] = args;\n\n    const image = await unpack_models(serializedImage, this.widget_manager);\n\n    if (image instanceof CanvasModel || image instanceof MultiCanvasModel) {\n      this._drawImage(image.canvas, x, y, width, height);\n      return;\n    }\n\n    if (image.get('_model_name') == 'ImageModel') {\n      const img = await createImageFromWidget(image);\n      this._drawImage(img, x, y, width, height);\n    }\n  }\n\n  private _drawImage(\n    image: HTMLCanvasElement | HTMLImageElement,\n    x: number,\n    y: number,\n    width?: number,\n    height?: number\n  ) {\n    if (width === undefined || height === undefined) {\n      this.ctx.drawImage(image, x, y);\n    } else {\n      this.ctx.drawImage(image, x, y, width, height);\n    }\n  }\n\n  async putImageData(args: any[], buffers: any) {\n    const [x, y] = args;\n\n    const image = await bufferToImage(buffers[0]);\n\n    this._drawImage(image, x, y);\n  }\n\n  async setAttr(attr: number, value: any) {\n    if (typeof value === 'string' && value.startsWith('IPY')) {\n      const widgetModel: GradientModel = await unpack_models(\n        value,\n        this.widget_manager\n      );\n      value = widgetModel.value;\n    }\n\n    (this.ctx as any)[CanvasModel.ATTRS[attr]] = value;\n  }\n\n  clearCanvas() {\n    this.forEachView((view: CanvasView) => {\n      view.clear();\n    });\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n  }\n\n  executeCommand(name: string, args: any[] = []) {\n    (this.ctx as any)[name](...args);\n  }\n\n  private forEachView(callback: (view: CanvasView) => void) {\n    for (const view_id in this.views) {\n      this.views[view_id].then((view: CanvasView) => {\n        callback(view);\n      });\n    }\n  }\n\n  private resizeCanvas() {\n    this.canvas.setAttribute('width', this.get('width'));\n    this.canvas.setAttribute('height', this.get('height'));\n  }\n\n  private async syncImageData() {\n    if (!this.get('sync_image_data')) {\n      return;\n    }\n\n    const bytes = await toBytes(this.canvas);\n\n    this.set('image_data', bytes);\n    this.save_changes();\n  }\n\n  static model_name = 'CanvasModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n  static view_name = 'CanvasView';\n  static view_module = MODULE_NAME;\n  static view_module_version = MODULE_VERSION;\n\n  canvas: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n\n  views: Dict<Promise<CanvasView>>;\n}\n\nexport class RoughCanvasModel extends CanvasModel {\n  static ROUGH_ATTRS: string[] = new Array(100).concat([\n    'roughFillStyle',\n    'roughness',\n    'bowing'\n  ]);\n\n  defaults() {\n    return { ...super.defaults(), _model_name: RoughCanvasModel.model_name };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.roughCanvas = new RoughCanvas(this.canvas);\n  }\n\n  fillRect(x: number, y: number, width: number, height: number) {\n    this.roughCanvas.rectangle(x, y, width, height, this.getRoughFillStyle());\n  }\n\n  strokeRect(x: number, y: number, width: number, height: number) {\n    this.roughCanvas.rectangle(x, y, width, height, this.getRoughStrokeStyle());\n  }\n\n  fillCircle(x: number, y: number, radius: number) {\n    this.roughCanvas.circle(x, y, 2 * radius, this.getRoughFillStyle());\n  }\n\n  strokeCircle(x: number, y: number, radius: number) {\n    this.roughCanvas.circle(x, y, 2 * radius, this.getRoughStrokeStyle());\n  }\n\n  strokeLine(args: any[], buffers: any) {\n    this.roughCanvas.line(\n      args[0],\n      args[1],\n      args[2],\n      args[3],\n      this.getRoughStrokeStyle()\n    );\n  }\n\n  strokeLines(args: any[], buffers: any) {\n    const points = getArg(args[0], buffers);\n\n    const polygon: [number, number][] = [];\n    for (let idx = 0; idx < points.length; idx += 2) {\n      polygon.push([points.getItem(idx), points.getItem(idx + 1)]);\n    }\n\n    this.roughCanvas.linearPath(polygon, this.getRoughStrokeStyle());\n  }\n\n  async fillPath(args: any[], buffers: any) {\n    const [serializedPath] = args;\n\n    const path = await unpack_models(serializedPath, this.widget_manager);\n\n    this.roughCanvas.path(path.get('value'), this.getRoughFillStyle());\n  }\n\n  fillArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    const ellipseSize = 2 * radius;\n\n    // The following is needed because roughjs does not allow a clockwise draw\n    const start = anticlockwise ? endAngle : startAngle;\n    const end = anticlockwise ? startAngle + 2 * Math.PI : endAngle;\n\n    this.roughCanvas.arc(\n      x,\n      y,\n      ellipseSize,\n      ellipseSize,\n      start,\n      end,\n      true,\n      this.getRoughFillStyle()\n    );\n  }\n\n  strokeArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    const ellipseSize = 2 * radius;\n\n    // The following is needed because roughjs does not allow a clockwise draw\n    const start = anticlockwise ? endAngle : startAngle;\n    const end = anticlockwise ? startAngle + 2 * Math.PI : endAngle;\n\n    this.roughCanvas.arc(\n      x,\n      y,\n      ellipseSize,\n      ellipseSize,\n      start,\n      end,\n      false,\n      this.getRoughStrokeStyle()\n    );\n  }\n\n  fillPolygon(args: any[], buffers: any) {\n    const points = getArg(args[0], buffers);\n\n    const polygon: [number, number][] = [];\n    for (let idx = 0; idx < points.length; idx += 2) {\n      polygon.push([points.getItem(idx), points.getItem(idx + 1)]);\n    }\n\n    this.roughCanvas.polygon(polygon, this.getRoughFillStyle());\n  }\n\n  strokePolygon(args: any[], buffers: any) {\n    const points = getArg(args[0], buffers);\n\n    const polygon: [number, number][] = [];\n    for (let idx = 0; idx < points.length; idx += 2) {\n      polygon.push([points.getItem(idx), points.getItem(idx + 1)]);\n    }\n\n    this.roughCanvas.polygon(polygon, this.getRoughStrokeStyle());\n  }\n\n  async setAttr(attr: number, value: any) {\n    if (RoughCanvasModel.ROUGH_ATTRS[attr]) {\n      (this as any)[RoughCanvasModel.ROUGH_ATTRS[attr]] = value;\n\n      return;\n    }\n\n    await super.setAttr(attr, value);\n  }\n\n  private getRoughFillStyle() {\n    const fill = this.ctx.fillStyle as string;\n    const lineWidth = this.ctx.lineWidth;\n\n    return {\n      fill,\n      fillStyle: this.roughFillStyle,\n      fillWeight: lineWidth / 2,\n      hachureGap: lineWidth * 4,\n      curveStepCount: 18,\n      strokeWidth: 0.001, // This is to ensure there is no stroke,\n      roughness: this.roughness,\n      bowing: this.bowing\n    };\n  }\n\n  private getRoughStrokeStyle() {\n    const stroke = this.ctx.strokeStyle as string;\n    const lineWidth = this.ctx.lineWidth;\n\n    return {\n      stroke,\n      strokeWidth: lineWidth,\n      roughness: this.roughness,\n      bowing: this.bowing,\n      curveStepCount: 18\n    };\n  }\n\n  static model_name = 'RoughCanvasModel';\n\n  roughCanvas: RoughCanvas;\n\n  roughFillStyle: string = 'hachure';\n  roughness: number = 1;\n  bowing: number = 1;\n}\n\nexport class CanvasView extends DOMWidgetView {\n  render() {\n    this.ctx = getContext(this.el);\n\n    this.resizeCanvas();\n    this.model.on_some_change(['width', 'height'], this.resizeCanvas, this);\n\n    this.el.addEventListener('mousemove', {\n      handleEvent: this.onMouseMove.bind(this)\n    });\n    this.el.addEventListener('mousedown', {\n      handleEvent: this.onMouseDown.bind(this)\n    });\n    this.el.addEventListener('mouseup', {\n      handleEvent: this.onMouseUp.bind(this)\n    });\n    this.el.addEventListener('mouseout', {\n      handleEvent: this.onMouseOut.bind(this)\n    });\n    this.el.addEventListener('touchstart', {\n      handleEvent: this.onTouchStart.bind(this)\n    });\n    this.el.addEventListener('touchend', {\n      handleEvent: this.onTouchEnd.bind(this)\n    });\n    this.el.addEventListener('touchmove', {\n      handleEvent: this.onTouchMove.bind(this)\n    });\n    this.el.addEventListener('touchcancel', {\n      handleEvent: this.onTouchCancel.bind(this)\n    });\n    this.el.addEventListener('keydown', {\n      handleEvent: this.onKeyDown.bind(this)\n    });\n\n    this.el.setAttribute('tabindex', '0');\n\n    this.updateCanvas();\n  }\n\n  clear() {\n    this.ctx.clearRect(0, 0, this.el.width, this.el.height);\n  }\n\n  updateCanvas() {\n    this.clear();\n    this.ctx.drawImage(this.model.canvas, 0, 0);\n  }\n\n  protected resizeCanvas() {\n    this.el.setAttribute('width', this.model.get('width'));\n    this.el.setAttribute('height', this.model.get('height'));\n  }\n\n  private onMouseMove(event: MouseEvent) {\n    this.model.send({ event: 'mouse_move', ...this.getCoordinates(event) }, {});\n  }\n\n  private onMouseDown(event: MouseEvent) {\n    // Bring focus to the canvas element, so keyboard events can be triggered\n    this.el.focus();\n\n    this.model.send({ event: 'mouse_down', ...this.getCoordinates(event) }, {});\n  }\n\n  private onMouseUp(event: MouseEvent) {\n    this.model.send({ event: 'mouse_up', ...this.getCoordinates(event) }, {});\n  }\n\n  private onMouseOut(event: MouseEvent) {\n    this.model.send({ event: 'mouse_out', ...this.getCoordinates(event) }, {});\n  }\n\n  private onTouchStart(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_start',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onTouchEnd(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_end',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onTouchMove(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_move',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onTouchCancel(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_cancel',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onKeyDown(event: KeyboardEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.model.send(\n      {\n        event: 'key_down',\n        key: event.key,\n        shift_key: event.shiftKey,\n        ctrl_key: event.ctrlKey,\n        meta_key: event.metaKey\n      },\n      {}\n    );\n  }\n\n  protected getCoordinates(event: MouseEvent | Touch) {\n    const rect = this.el.getBoundingClientRect();\n\n    const x = (this.el.width * (event.clientX - rect.left)) / rect.width;\n    const y = (this.el.height * (event.clientY - rect.top)) / rect.height;\n\n    return { x, y };\n  }\n\n  get tagName(): string {\n    return 'canvas';\n  }\n\n  el: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n\n  model: CanvasModel | MultiCanvasModel;\n}\n\nexport class MultiCanvasModel extends DOMWidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: MultiCanvasModel.model_name,\n      _model_module: MultiCanvasModel.model_module,\n      _model_module_version: MultiCanvasModel.model_module_version,\n      _view_name: MultiCanvasModel.view_name,\n      _view_module: MultiCanvasModel.view_module,\n      _view_module_version: MultiCanvasModel.view_module_version,\n      _canvases: [],\n      sync_image_data: false,\n      image_data: null,\n      width: 700,\n      height: 500\n    };\n  }\n\n  static serializers: ISerializers = {\n    ...DOMWidgetModel.serializers,\n    _canvases: { deserialize: unpack_models as any },\n    image_data: {\n      serialize: (bytes: Uint8ClampedArray) => {\n        return new DataView(bytes.buffer.slice(0));\n      }\n    }\n  };\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.canvas = document.createElement('canvas');\n    this.ctx = getContext(this.canvas);\n\n    this.resizeCanvas();\n\n    this.on_some_change(['width', 'height'], this.resizeCanvas, this);\n    this.on('change:_canvases', this.updateCanvasModels.bind(this));\n    this.on('change:sync_image_data', this.syncImageData.bind(this));\n\n    this.updateCanvasModels();\n  }\n\n  get canvasModels(): CanvasModel[] {\n    return this.get('_canvases');\n  }\n\n  private updateCanvasModels() {\n    // TODO: Remove old listeners\n    for (const canvasModel of this.canvasModels) {\n      canvasModel.on('new-frame', this.updateCanvas, this);\n    }\n\n    this.updateCanvas();\n  }\n\n  private updateCanvas() {\n    this.ctx.clearRect(0, 0, this.get('width'), this.get('height'));\n\n    for (const canvasModel of this.canvasModels) {\n      this.ctx.drawImage(canvasModel.canvas, 0, 0);\n    }\n\n    this.forEachView((view: MultiCanvasView) => {\n      view.updateCanvas();\n    });\n\n    this.syncImageData();\n  }\n\n  private resizeCanvas() {\n    this.canvas.setAttribute('width', this.get('width'));\n    this.canvas.setAttribute('height', this.get('height'));\n  }\n\n  private async syncImageData() {\n    if (!this.get('sync_image_data')) {\n      return;\n    }\n\n    const bytes = await toBytes(this.canvas);\n\n    this.set('image_data', bytes);\n    this.save_changes();\n  }\n\n  private forEachView(callback: (view: MultiCanvasView) => void) {\n    for (const view_id in this.views) {\n      this.views[view_id].then((view: MultiCanvasView) => {\n        callback(view);\n      });\n    }\n  }\n\n  canvas: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n\n  views: Dict<Promise<MultiCanvasView>>;\n\n  static model_name = 'MultiCanvasModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n  static view_name = 'MultiCanvasView';\n  static view_module = MODULE_NAME;\n  static view_module_version = MODULE_VERSION;\n}\n\nexport class MultiCanvasView extends CanvasView {\n  model: MultiCanvasModel;\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__146__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(112);\n"],"names":["exports","byteLength","b64","lens","getLens","validLen","placeHoldersLen","toByteArray","tmp","i","arr","Arr","_byteLength","curByte","len","revLookup","charCodeAt","fromByteArray","uint8","length","extraBytes","parts","maxChunkLength","len2","push","encodeChunk","lookup","join","Uint8Array","Array","code","Error","indexOf","start","end","num","output","base64","ieee754","isArray","kMaxLength","Buffer","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","__proto__","prototype","arg","encodingOrOffset","this","allocUnsafe","from","value","TypeError","ArrayBuffer","array","byteOffset","undefined","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","slice","fromString","obj","isBuffer","checked","copy","buffer","val","type","data","fromObject","assertSize","size","toString","isView","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","b","n","m","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","call","lastIndexOf","indexSize","arrLength","valLength","String","read","buf","readUInt16BE","foundIndex","found","j","hexWrite","offset","Number","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","units","c","hi","lo","utf16leToBytes","Math","min","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","apply","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","g","foo","subarray","e","typedArraySupport","poolSize","_augment","Symbol","species","Object","defineProperty","configurable","fill","allocUnsafeSlow","_isBuffer","compare","a","x","y","concat","list","pos","swap16","swap32","swap64","arguments","equals","inspect","max","match","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","ret","out","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","set","INVALID_BASE64_RE","Infinity","leadSurrogate","trim","replace","stringtrim","base64clean","src","dst","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","d","s","NaN","rt","abs","log","LN2","module","rotatePoints","points","center","degrees","cx","cy","angle","PI","cos","sin","forEach","p","lineLength","line","p1","p2","sqrt","polygonHachureLines","polygonList","o","hachureAngle","gap","hachureGap","strokeWidth","rotationCenter","polygon","lines","vertexArray","vertices","edges","ymin","ymax","islope","sort","e1","e2","activeEdges","ix","splice","edge","filter","ae","ae1","ae2","nexti","ce","ne","round","straightHachureLines","rotateLines","HachureFiller","constructor","helper","fillPolygons","_fillPolygons","ops","renderLines","doubleLineOps","ZigZagFiller","assign","zigZagAngle","zigzagLines","dgx","dgy","HatchFiller","o2","set2","DotFiller","dotsOnLines","fweight","fillWeight","ro","dl","count","ceil","minY","random","el","ellipse","DashedFiller","dashedLine","dashOffset","dashGap","startOffset","alpha","atan","lstart","lend","ZigZagLineFiller","zo","zigzagOffset","dz","middle","fillers","Random","seed","next","imul","PARAMS","A","C","H","h","L","l","M","Q","q","S","T","t","V","v","Z","z","isType","token","parsePath","segments","tokens","RegExp","$1","text","parseFloat","tokenize","mode","index","paramsCount","params","numbeToken","segment","key","absolutize","subx","suby","newdata","map","normalize","lastType","lcx","lcy","cx1","cy1","x1","y1","cx2","cy2","r1","r2","largeArcFlag","sweepFlag","arcToCubicCurves","curve","rotate","angleRad","x2","y2","recursive","f1","f2","r1Pow","r2Pow","left","right","k","asin","toFixed","df","f2old","x2old","y2old","c1","s1","c2","s2","tan","hx","hy","m1","m2","m3","m4","curves","r3","randOffset","_offsetOpt","randOffsetWithRange","_offset","width","height","ellipseWithParams","generateEllipseParams","opset","_doubleLine","linearPath","close","psq","stepCount","curveStepCount","increment","rx","ry","curveFitRandomness","curveFitting","ellipseParams","ap1","cp1","_computeEllipsePoints","o1","_curve","disableMultiStroke","roughness","ap2","estimatedPoints","arc","stop","closed","roughClosure","strt","stp","ellipseInc","arcInc","_arc","op","solidFillPolygon","maxRandomnessOffset","patternFillPolygons","fillerName","fillStyle","getFiller","randomizer","roughnessGain","filling","singleStroke","disableMultiStrokeFill","_line","move","overlay","lengthSq","halfOffset","divergePoint","midDispX","bowing","midDispY","randomHalf","randomFull","preserveVertices","_curveWithOffset","ps","closePoint","curveTightness","cachedVertArray","overlap","corePoints","allPoints","radOffset","endAngle","_bezierTo","current","ros","f","iterations","clone","distanceSq","distanceToSegmentSq","w","l2","lerp","getPointsOnBezierCurveWithSplitting","tolerance","newPoints","outPoints","p3","p4","ux","uy","vx","vy","flatness","p0","q1","q2","q3","red","simplify","distance","simplifyPoints","epsilon","maxDistSq","maxNdx","distSq","pointsOnBezierCurves","numSegments","NOS","RoughGenerator","config","defaultOptions","stroke","options","_o","static","_d","shape","sets","rectangle","paths","outline","ellipseResponse","circle","diameter","fillOptions","patternFillArc","result","cloneOptionsAlterSeed","bcurve","pointsIn","curveToBezier","polyPoints","path","hasFill","hasStroke","simplified","simplification","normalized","currentPoints","pendingCurve","appendPendingCurve","appendPendingPoints","lastPoint","simplifiedSet","pointsOnPath","first","pv","svgPath","opsToPath","drawing","fixedDecimals","item","toPaths","drawable","fillSketch","RoughCanvas","canvas","ctx","getContext","gen","draw","getDefaultOptions","precision","fixedDecimalPlaceDigits","save","strokeStyle","lineWidth","strokeLineDash","setLineDash","strokeLineDashOffset","lineDashOffset","_drawToContext","restore","fillRule","fillLineDash","fillLineDashOffset","rule","beginPath","moveTo","bezierCurveTo","lineTo","generator","window","__webpack_public_path__","document","querySelector","getAttribute","Scalar","getTypedArray","dataview","metadata","dtype","Int8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","isScalar","Arg","ScalarArg","super","getItem","idx","BufferArg","bufferMetadata","toBlob","Promise","resolve","reject","blob","buffers","reader","FileReader","onloadend","Uint8ClampedArray","readAsArrayBuffer","Blob","img","Image","onload","URL","createObjectURL","url","MODULE_VERSION","version","MODULE_NAME","name","context","createImageFromWidget","image","format","get","TextDecoder","decode","COMMANDS","CanvasManagerModel","WidgetModel","currentProcessing","canvasesToUpdate","defaults","_model_name","model_name","_model_module","model_module","_model_module_version","model_module_version","initialize","attributes","on","command","then","onCommand","commands","JSON","parse","currentCanvas","processCommand","syncViews","remainingBuffers","subcommand","subbuffers","nBuffers","args","switchCanvas","sleep","fillRect","strokeRect","drawRects","bind","fillArc","strokeArc","drawArcs","fillCircle","strokeCircle","drawCircles","strokeLine","strokeLines","fillPolygon","strokePolygon","fillPath","drawImage","putImageData","setAttr","clearCanvas","drawPolygonOrLineSegments","drawStyledRects","drawStyledCircles","drawStyledArcs","drawStyledPolygonOrLineSegments","executeCommand","serializedCanvas","unpack_models","widget_manager","Path2DModel","Path2D","PatternModel","repetition","patternSource","CanvasModel","MultiCanvasModel","pattern","createPattern","serializers","deserialize","createElement","GradientModel","x0","y0","color_stops","createGradient","colorStop","addColorStop","createLinearGradient","LinearGradientModel","RadialGradientModel","r0","createRadialGradient","DOMWidgetModel","_view_name","view_name","_view_module","view_module","_view_module_version","view_module_version","sync_image_data","image_data","_send_client_ready_event","resizeCanvas","drawImageData","on_some_change","syncImageData","send","event","fromBytes","trigger","forEachView","view","updateCanvas","time","setTimeout","callback","getArg","numberRects","colors","ci","color","setStyle","radius","startAngle","anticlockwise","closePath","numberArcs","numberCircles","style","numPolygons","sizes","idp","serializedPath","serializedImage","_drawImage","bufferToImage","attr","startsWith","widgetModel","ATTRS","clear","clearRect","view_id","views","setAttribute","toBytes","save_changes","serialize","DataView","RoughCanvasModel","roughFillStyle","roughCanvas","getRoughFillStyle","getRoughStrokeStyle","ellipseSize","ROUGH_ATTRS","CanvasView","DOMWidgetView","render","model","addEventListener","handleEvent","onMouseMove","onMouseDown","onMouseUp","onMouseOut","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","onKeyDown","getCoordinates","focus","touches","preventDefault","stopPropagation","shift_key","shiftKey","ctrl_key","ctrlKey","meta_key","metaKey","rect","getBoundingClientRect","clientX","clientY","top","tagName","_canvases","updateCanvasModels","canvasModels","canvasModel","__WEBPACK_EXTERNAL_MODULE__146__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","enumerable","globalThis","Function","prop","hasOwnProperty","r","toStringTag"],"sourceRoot":""}